!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(l,i,b){function a(g,n){if(!i[g]){if(!l[g]){var f="function"==typeof require&&require;if(!n&&f){return f(g,!0)}if(e){return e(g,!0)}var h=new Error("Cannot find module '"+g+"'");throw h.code="MODULE_NOT_FOUND",h}var j=i[g]={exports:{}};l[g][0].call(j.exports,function(p){var m=l[g][1][p];return a(m?m:p)},j,j.exports,d,l,i,b)}return i[g].exports}for(var e="function"==typeof require&&require,k=0;k<b.length;k++){a(b[k])}return a}({1:[function(e,n,a){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function b(f){return"function"==typeof f}function m(f){return"number"==typeof f}function i(f){return"object"==typeof f&&null!==f}function p(f){return void 0===f}n.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(f){if(!m(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},o.prototype.emit=function(k){var g,f,h,j,r,l;if(this._events||(this._events={}),"error"===k&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(g=arguments[1],g instanceof Error){throw g}throw TypeError('Uncaught, unspecified "error" event.')}if(f=this._events[k],p(f)){return !1}if(b(f)){switch(arguments.length){case 1:f.call(this);break;case 2:f.call(this,arguments[1]);break;case 3:f.call(this,arguments[1],arguments[2]);break;default:j=Array.prototype.slice.call(arguments,1),f.apply(this,j)}}else{if(i(f)){for(j=Array.prototype.slice.call(arguments,1),l=f.slice(),h=l.length,r=0;h>r;r++){l[r].apply(this,j)}}}return !0},o.prototype.addListener=function(f,g){var h;if(!b(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,b(g.listener)?g.listener:g),this._events[f]?i(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,i(this._events[f])&&!this._events[f].warned&&(h=p(this._maxListeners)?o.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(j,g){function h(){this.removeListener(j,h),f||(f=!0,g.apply(this,arguments))}if(!b(g)){throw TypeError("listener must be a function")}var f=!1;return h.listener=g,this.on(j,h),this},o.prototype.removeListener=function(j,f){var g,h,l,k;if(!b(f)){throw TypeError("listener must be a function")}if(!this._events||!this._events[j]){return this}if(g=this._events[j],l=g.length,h=-1,g===f||b(g.listener)&&g.listener===f){delete this._events[j],this._events.removeListener&&this.emit("removeListener",j,f)}else{if(i(g)){for(k=l;k-->0;){if(g[k]===f||g[k].listener&&g[k].listener===f){h=k;break}}if(0>h){return this}1===g.length?(g.length=0,delete this._events[j]):g.splice(h,1),this._events.removeListener&&this.emit("removeListener",j,f)}}return this},o.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],b(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},o.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?b(this._events[f])?[this._events[f]]:this._events[f].slice():[]},o.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(b(g)){return 1}if(g){return g.length}}return 0},o.listenerCount=function(f,g){return f.listenerCount(g)}},{}],2:[function(r,o,B){function e(){t&&f&&(t=!1,f.length?i=f.concat(i):a=-1,i.length&&b())}function b(){if(!t){var g=n(e);t=!0;for(var j=i.length;j;){for(f=i,i=[];++a<j;){f&&f[a].run()}a=-1,j=i.length}f=null,t=!1,h(g)}}function u(g,j){this.fun=g,this.array=j}function l(){}var n,h,s=o.exports={};!function(){try{n=setTimeout}catch(g){n=function(){throw new Error("setTimeout is not defined")}}try{h=clearTimeout}catch(g){h=function(){throw new Error("clearTimeout is not defined")}}}();var f,i=[],t=!1,a=-1;s.nextTick=function(j){var k=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){k[g-1]=arguments[g]}}i.push(new u(j,k)),1!==i.length||t||n(b,0)},u.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=l,s.addListener=l,s.once=l,s.off=l,s.removeListener=l,s.removeAllListeners=l,s.emit=l,s.binding=function(g){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(g){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],3:[function(e,a,b){(function(iC,jt){function fy(t){return t&&"object"==typeof t&&"default" in t?t["default"]:t}function ee(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function ge(aa){if("function"==typeof aa.slice){return aa.slice(0)}var ac=new ArrayBuffer(aa.byteLength),t=new Uint8Array(ac),ab=new Uint8Array(aa);return t.set(ab),ac}function gX(t){if(t instanceof ArrayBuffer){return ge(t)}var aa=t.size,ab=t.type;return"function"==typeof t.slice?t.slice(0,aa,ab):t.webkitSlice(0,aa,ab)}function gM(t){var aa=Object.getPrototypeOf(t);if(null===aa){return !0}var ab=aa.constructor;return"function"==typeof ab&&ab instanceof ab&&de.call(ab)==gN}function g9(t){var ab,ac,aa;if(!t||"object"!=typeof t){return t}if(Array.isArray(t)){for(ab=[],ac=0,aa=t.length;aa>ac;ac++){ab[ac]=g9(t[ac])}return ab}if(t instanceof Date){return t.toISOString()}if(ee(t)){return gX(t)}if(!gM(t)){return t}ab={};for(ac in t){if(Object.prototype.hasOwnProperty.call(t,ac)){var ad=g9(t[ac]);"undefined"!=typeof ad&&(ab[ac]=ad)}}return ab}function fZ(t){var aa=!1;return hg(function(ab){if(aa){throw new Error("once called more than once")}aa=!0,t.apply(this,ab)})}function er(t){return hg(function(ac){ac=g9(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ah,ag){iC.nextTick(function(){ad(ah,ag)})});var af=new gi(function(ak,al){var ah;try{var aj=fZ(function(ap,am){ap?al(ap):ak(am)});ac.push(aj),ah=t.apply(aa,ac),ah&&"function"==typeof ah.then&&ak(ah)}catch(ag){al(ag)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function co(t,aa){function ab(af,ah,ac){if(ju.enabled){for(var ag=[af._db_name,ah],ad=0;ad<ac.length-1;ad++){ag.push(ac[ad])}ju.apply(null,ag);var aj=ac[ac.length-1];ac[ac.length-1]=function(ak,am){var al=[af._db_name,ah];al=al.concat(ak?["error",ak]:["success",am]),ju.apply(null,al),aj(ak,am)}}}return er(hg(function(ad){if(this._closed){return gi.reject(new Error("database is closed"))}if(this._destroyed){return gi.reject(new Error("database is destroyed"))}var ac=this;return ab(ac,t,ad),this.taskqueue.isReady?aa.apply(this,ad):new gi(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[t].apply(ac,ad))})})}))}function fc(t,ab){for(var ac={},aa=0,ad=ab.length;ad>aa;aa++){var af=ab[aa];af in t&&(ac[af]=t[af])}return ac}function fU(t){return t}function gl(t){return[{ok:t}]}function gf(am,ah,aq){function ak(){var av=[];ap.forEach(function(aw){aw.docs.forEach(function(ax){av.push({id:aw.id,docs:[ax]})})}),aq(null,{results:av})}function af(){++ag===ab&&ak()}function aa(ax,av,aw){ap[ax]={id:av,docs:aw},af()}function ac(){if(!(t>=au.length)){var av=Math.min(t+hi,au.length),aw=au.slice(t,av);al(aw,t),t+=aw.length}}function al(av,aw){av.forEach(function(ay,aC){var aA=aw+aC,ax=aj[ay],az=fc(ax[0],["atts_since","attachments"]);az.open_revs=ax.map(function(aD){return aD.rev}),az.open_revs=az.open_revs.filter(fU);var aB=fU;0===az.open_revs.length&&(delete az.open_revs,aB=gl),["revs","attachments","binary","ajax"].forEach(function(aD){aD in ah&&(az[aD]=ah[aD])}),am.get(ay,az,function(aD,aF){var aE;aE=aD?[{error:aD}]:aB(aF),aa(aA,ay,aE),ac()})})}var ad=ah.docs,aj={};ad.forEach(function(av){av.id in aj?aj[av.id].push(av):aj[av.id]=[av]});var ab=Object.keys(aj).length,ag=0,ap=new Array(ab),au=Object.keys(aj),t=0;ac()}function iz(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function ga(){return at}function cn(t){iz()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):ga()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function gC(){i5.EventEmitter.call(this),this._listeners={},cn(this)}function iO(t){if("undefined"!==console&&t in console){var aa=Array.prototype.slice.call(arguments,1);console[t].apply(console,aa)}}function fi(t,ab){var ac=600000;t=parseInt(t,10)||0,ab=parseInt(ab,10),ab!==ab||t>=ab?ab=(t||1)<<1:ab+=1,ab>ac&&(t=ac>>1,ab=ac);var aa=Math.random(),ad=ab-t;return ~~(ad*aa+t)}function fp(t){var aa=0;return t||(aa=2000),fi(t,aa)}function iu(t,aa){iO("info","The above "+t+" is totally normal. "+aa)}function hE(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function ii(aa,ac,t){function ab(af){for(var ad in aa){"function"!=typeof aa[ad]&&(this[ad]=aa[ad])}void 0!==t&&(this.name=t),void 0!==af&&(this.reason=af)}return ab.prototype=hE.prototype,new ab(ac)}function go(t){var ab,ac,aa,ad,af;return ac=t.error===!0&&"string"==typeof t.name?t.name:t.error,af=t.reason,aa=gu("name",ac,af),t.missing||"missing"===af||"deleted"===af||"not_found"===ac?aa=h5:"doc_validation"===ac?(aa=ei,ad=af):"bad_request"===ac&&aa.message!==af&&(aa=fn),aa||(aa=gu("status",t.status,af)||ew),ab=ii(aa,af,ac),ad&&(ab.message=ad),t.id&&(ab.id=t.id),t.status&&(ab.status=t.status),t.missing&&(ab.missing=t.missing),ab}function iS(t,ab,ac){try{return !t(ab,ac)}catch(aa){var ad="Filter function threw: "+aa.toString();return ii(fn,ad)}}function jB(t){var aa={},ab=t.filter&&"function"==typeof t.filter;return aa.query=t.query_params,function(ad){ad.doc||(ad.doc={});var ac=ab&&iS(t.filter,ad.doc,aa);if("object"==typeof ac){return ac}if(ac){return !1}if(t.include_docs){if(!t.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function a9(aa){for(var ac=[],t=0,ab=aa.length;ab>t;t++){ac=ac.concat(aa[t])}return ac}function hs(t){var aa;if(t?"string"!=typeof t?aa=ii(hO):/^_/.test(t)&&!/^_(design|local)/.test(t)&&(aa=ii(et)):aa=ii(fV),aa){throw aa}}function hn(t,aa){return"listenerCount" in t?t.listenerCount(aa):i5.EventEmitter.listenerCount(t,aa)}function jd(t){if(!t){return null}var aa=t.split("/");return 2===aa.length?aa:1===aa.length?[t,t]:null}function gE(t){var aa=jd(t);return aa?aa.join("/"):null}function h2(ad){for(var aa=be.exec(ad),ag={},t=14;t--;){var ac=q[t],ab=aa[t]||"",af=-1!==["user","password"].indexOf(ac);ag[ac]=af?decodeURIComponent(ab):ab}return ag[hG]={},ag[q[12]].replace(ez,function(ah,ak,aj){ak&&(ag[hG][ak]=aj)}),ag}function R(t,aa,ab){return new gi(function(ad,ac){t.get(aa,function(aj,ag){if(aj){if(404!==aj.status){return ac(aj)}ag={}}var ah=ag._rev,af=ab(ag);return af?(af._id=aa,af._rev=ah,void ad(hF(t,af,ab))):ad({updated:!1,rev:ah})})})}function hF(t,aa,ab){return t.put(aa).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return R(t,aa._id,ab)})}function fd(t){return 0|Math.random()*t}function fu(aa,ac){ac=ac||fX.length;var t="",ab=-1;if(aa){for(;++ab<aa;){t+=fX[fd(ac)]}return t}for(;++ab<36;){switch(ab){case 8:case 13:case 18:case 23:t+="-";break;case 19:t+=fX[3&fd(16)|8];break;default:t+=fX[fd(16)]}}return t}function g0(t){for(var ap,ak,am,al,ah=t.rev_tree.slice();al=ah.pop();){var ab=al.ids,ag=ab[2],aa=al.pos;if(ag.length){for(var ac=0,af=ag.length;af>ac;ac++){ah.push({pos:aa+1,ids:ag[ac]})}}else{var aj=!!ab[1].deleted,ad=ab[0];ap&&!(am!==aj?am:ak!==aa?aa>ak:ad>ap)||(ap=ad,ak=aa,am=aj)}}return ak+"-"+ap}function a3(ah,af){for(var ak,ac=ah.slice();ak=ac.pop();){for(var aa=ak.pos,aj=ak.ids,ag=aj[2],ad=af(0===ag.length,aa,aj[0],ak.ctx,aj[1]),t=0,ab=ag.length;ab>t;t++){ac.push({pos:aa+1,ids:ag[t],ctx:ad})}}}function iD(t,aa){return t.pos-aa.pos}function w(aa){var ac=[];a3(aa,function(ah,af,aj,ag,ad){ah&&ac.push({rev:af+"-"+aj,pos:af,opts:ad})}),ac.sort(iD).reverse();for(var t=0,ab=ac.length;ab>t;t++){delete ac[t].pos}return ac}function gk(ad){for(var aa=g0(ad),ag=w(ad.rev_tree),t=[],ac=0,ab=ag.length;ab>ac;ac++){var af=ag[ac];af.rev===aa||af.opts.deleted||t.push(af.rev)}return t}function g6(t){var aa=[];return a3(t.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(aa.push(ag+"-"+ad),af.status="missing")}),aa}function hB(t){for(var ap,ak=[],am=t.slice();ap=am.pop();){var al=ap.pos,ah=ap.ids,ab=ah[0],ag=ah[1],aa=ah[2],ac=0===aa.length,af=ap.history?ap.history.slice():[];af.push({id:ab,opts:ag}),ac&&ak.push({pos:al+1-af.length,ids:af});for(var aj=0,ad=aa.length;ad>aj;aj++){am.push({pos:al+1,ids:aa[aj],history:af})}}return ak.reverse()}function fS(t,aa){return t.pos-aa.pos}function iT(t,ab,ac){for(var aa,ad=0,af=t.length;af>ad;){aa=ad+af>>>1,ac(t[aa],ab)<0?ad=aa+1:af=aa}return ad}function di(aa,ac,t){var ab=iT(aa,ac,t);aa.splice(ab,0,ac)}function hR(ag,af){for(var t,ad,ab=af,aa=ag.length;aa>ab;ab++){var ac=ag[ab],ah=[ac.id,ac.opts,[]];ad?(ad[2].push(ah),ad=ah):t=ad=ah}return t}function a4(t,aa){return t[0]<aa[0]?-1:1}function eo(ah,af){for(var ak=[{tree1:ah,tree2:af}],ac=!1;ak.length>0;){var aa=ak.pop(),aj=aa.tree1,ag=aa.tree2;(aj[1].status||ag[1].status)&&(aj[1].status="available"===aj[1].status||"available"===ag[1].status?"available":"missing");for(var ad=0;ad<ag[2].length;ad++){if(aj[2][0]){for(var t=!1,ab=0;ab<aj[2].length;ab++){aj[2][ab][0]===ag[2][ad][0]&&(ak.push({tree1:aj[2][ab],tree2:ag[2][ad]}),t=!0)}t||(ac="new_branch",di(aj[2],ag[2][ad],a4))}else{ac="new_leaf",aj[2][0]=ag[2][ad]}}}return{conflicts:ac,tree:ah}}function iM(ab,af,ad){var aj,av=[],aq=!1,ah=!1;if(!ab.length){return{tree:[af],conflicts:"new_leaf"}}for(var ac=0,aw=ab.length;aw>ac;ac++){var ag=ab[ac];if(ag.pos===af.pos&&ag.ids[0]===af.ids[0]){aj=eo(ag.ids,af.ids),av.push({pos:ag.pos,ids:aj.tree}),aq=aq||aj.conflicts,ah=!0}else{if(ad!==!0){var al=ag.pos<af.pos?ag:af,t=ag.pos<af.pos?af:ag,am=t.pos-al.pos,ap=[],ax=[];for(ax.push({ids:al.ids,diff:am,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],ak=0,aa=az.length;aa>ak;ak++){ax.push({ids:az[ak],diff:ay.diff-1,parent:ay.ids,parentIdx:ak})}}else{ay.ids[0]===t.ids[0]&&ap.push(ay)}}var au=ap[0];au?(aj=eo(au.ids,t.ids),au.parent[2][au.parentIdx]=aj.tree,av.push({pos:al.pos,ids:al.ids}),aq=aq||aj.conflicts,ah=!0):av.push(ag)}else{av.push(ag)}}}return ah||av.push(af),av.sort(fS),{tree:av,conflicts:aq||"internal_node"}}function jE(t,ap){for(var ak,am=hB(t),al={},ah=0,ab=am.length;ab>ah;ah++){for(var ag=am[ah],aa=ag.ids,ac=Math.max(0,aa.length-ap),af={pos:ag.pos+ac,ids:hR(aa,ac)},aj=0;ac>aj;aj++){var ad=ag.pos+aj+"-"+aa[aj].id;al[ad]=!0}ak=ak?iM(ak,af,!0).tree:[af]}return a3(ak,function(av,aq,au){delete al[aq+"-"+au]}),{tree:ak,revs:Object.keys(al)}}function g(t,ab,ac){var aa=iM(t,ab),ad=jE(aa.tree,ac);return{tree:ad.tree,stemmedRevs:ad.revs,conflicts:aa.conflicts}}function jg(ah,af){for(var ak,ac=ah.slice(),aa=af.split("-"),aj=parseInt(aa[0],10),ag=aa[1];ak=ac.pop();){if(ak.pos===aj&&ak.ids[0]===ag){return !0}for(var ad=ak.ids[2],t=0,ab=ad.length;ab>t;t++){ac.push({pos:ak.pos+1,ids:ad[t]})}}return !1}function gz(t){return t.ids}function jo(t,ab){ab||(ab=g0(t));for(var ac,aa=ab.substring(ab.indexOf("-")+1),ad=t.rev_tree.map(gz);ac=ad.pop();){if(ac[0]===aa){return !!ac[1].deleted}ad=ad.concat(ac[2])}}function ex(t){return/^_local/.test(t)}function iv(t){return jC("return "+t+";",{})}function iP(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function jw(t,aa){try{t.emit("change",aa)}catch(ab){iO("error",'Error in .on("change", function):',ab)}}function bo(ad,aa,ag){function t(){ac.cancel()}i5.EventEmitter.call(this);var ac=this;this.db=ad,aa=aa?g9(aa):{};var ab=aa.complete=fZ(function(ah,aj){ah?hn(ac,"error")>0&&ac.emit("error",ah):ac.emit("complete",aj),ac.removeAllListeners(),ad.removeListener("destroyed",t)});ag&&(ac.on("complete",function(ah){ag(null,ah)}),ac.on("error",ag)),ad.once("destroyed",t),aa.onChange=function(ah){aa.isCancelled||(jw(ac,ah),ac.startSeq&&ac.startSeq<=ah.seq&&(ac.startSeq=!1))};var af=new gi(function(ah,aj){aa.complete=function(al,ak){al?aj(al):ah(ak)}});ac.once("cancel",function(){ad.removeListener("destroyed",t),aa.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){ab(null,ah)},ab),ad.taskqueue.isReady?ac.doChanges(aa):ad.taskqueue.addTask(function(){ac.isCancelled?ac.emit("cancel"):ac.doChanges(aa)})}function i1(t,ab,ac){var aa=[{rev:t._rev}];"all_docs"===ac.style&&(aa=w(ab.rev_tree).map(function(af){return{rev:af.rev}}));var ad={id:ab.id,changes:aa,doc:t};return jo(ab,t._rev)&&(ad.deleted=!0),ac.conflicts&&(ad.doc._conflicts=gk(ab),ad.doc._conflicts.length||delete ad.doc._conflicts),ad}function gO(t,aa){return aa>t?-1:t>aa?1:0}function gK(t,aa){for(var ab=0;ab<t.length;ab++){if(aa(t[ab],ab)===!0){return t[ab]}}}function gs(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function gA(t){for(var ab=0;ab<t.length;ab++){var ac=t[ab];if(ac._deleted){delete ac._attachments}else{if(ac._attachments){for(var aa=Object.keys(ac._attachments),ad=0;ad<aa.length;ad++){var af=aa[ad];ac._attachments[af]=fc(ac._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function ct(t,ab){var ac=gO(t._id,ab._id);if(0!==ac){return ac}var aa=t._revisions?t._revisions.start:0,ad=ab._revisions?ab._revisions.start:0;return gO(aa,ad)}function hU(t){var aa={},ab=[];return a3(t,function(ag,ah,af,ac){var ad=ah+"-"+af;return ag&&(aa[ad]=0),void 0!==ac&&ab.push({from:ac,to:ad}),ad}),ab.reverse(),ab.forEach(function(ac){void 0===aa[ac.from]?aa[ac.from]=1+aa[ac.to]:aa[ac.from]=Math.min(aa[ac.from],1+aa[ac.to])}),aa}function V(t,ab,ac){var aa="limit" in ab?ab.keys.slice(ab.skip,ab.limit+ab.skip):ab.skip>0?ab.keys.slice(ab.skip):ab.keys;if(ab.descending&&aa.reverse(),!aa.length){return t._allDocs({limit:0},ac)}var ad={offset:ab.skip};return gi.all(aa.map(function(af){var ag=hI.extend({key:af,deleted:"ok"},ab);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new gi(function(ah,aj){t._allDocs(ag,function(ak,al){return ak?aj(ak):(ad.total_rows=al.total_rows,void ah(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return ad.rows=af,ad})}function ev(aa){var ac=aa._compactionQueue[0],ab=ac.opts,t=ac.callback;aa.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(ab.last_seq=ad.last_seq),aa._compact(ab,function(ag,af){ag?t(ag):t(null,af),iC.nextTick(function(){aa._compactionQueue.shift(),aa._compactionQueue.length&&ev(aa)})})})}function h0(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function jl(){i5.EventEmitter.call(this)}function fv(){this.isReady=!1,this.failed=!1,this.queue=[]}function eu(t){t&&jt.debug&&iO("error",t)}function g4(ad,aa){function ag(){ab.emit("destroyed",ac)}function t(){ad.removeListener("destroyed",ag),ad.emit("destroyed",ad)}var ac=aa.originalName,ab=ad.constructor,af=ab._destructionListeners;ad.once("destroyed",ag),af.has(ac)||af.set(ac,[]),af.get(ac).push(t)}function fx(ad,aa,ag){if(!(this instanceof fx)){return new fx(ad,aa,ag)}var t=this;if("function"!=typeof aa&&"undefined"!=typeof aa||(ag=aa,aa={}),ad&&"object"==typeof ad&&(aa=ad,ad=void 0),"undefined"==typeof ag){ag=eu}else{var ac=ag;ag=function(){return iO("warn","Using a callback for new PouchDB()is deprecated."),ac.apply(null,arguments)}}ad=ad||aa.name,aa=g9(aa),delete aa.name,this.__opts=aa;var ab=ag;t.auto_compaction=aa.auto_compaction,t.prefix=fx.prefix,jl.call(t),t.taskqueue=new fv;var af=new gi(function(ah,ak){ag=function(ap,am){return ap?ak(ap):(delete am.then,void ah(am))},aa=g9(aa);var al,aj;return function(){try{if("string"!=typeof ad){throw aj=new Error("Missing/invalid DB name"),aj.code=400,aj}var ap=(aa.prefix||"")+ad;if(al=fx.parseAdapter(ap,aa),aa.originalName=ad,aa.name=al.name,aa.adapter=aa.adapter||al.adapter,t._adapter=aa.adapter,jm("pouchdb:adapter")("Picked adapter: "+aa.adapter),t._db_name=ad,!fx.adapters[aa.adapter]){throw aj=new Error("Adapter is missing"),aj.code=404,aj}if(!fx.adapters[aa.adapter].valid()){throw aj=new Error("Invalid Adapter"),aj.code=404,aj}}catch(am){t.taskqueue.fail(am)}}(),aj?ak(aj):(t.adapter=aa.adapter,t.replicate={},t.replicate.from=function(aq,am,ap){return t.constructor.replicate(aq,t,am,ap)},t.replicate.to=function(aq,am,ap){return t.constructor.replicate(t,aq,am,ap)},t.sync=function(aq,am,ap){return t.constructor.sync(t,aq,am,ap)},t.replicate.sync=t.sync,void fx.adapters[aa.adapter].call(t,aa,function(am){return am?(t.taskqueue.fail(am),void ag(am)):(g4(t,aa),t.emit("created",t),fx.emit("created",aa.originalName),t.taskqueue.ready(t),void ag(null,t))}))});af.then(function(ah){ab(null,ah)},ab),t.then=af.then.bind(af),t["catch"]=af["catch"].bind(af)}function hA(t){Object.keys(i5.EventEmitter.prototype).forEach(function(ab){"function"==typeof i5.EventEmitter.prototype[ab]&&(t[ab]=hM[ab].bind(hM))});var aa=t._destructionListeners=new hK.Map;t.on("destroyed",function(ab){aa.get(ab).forEach(function(ac){ac()}),aa["delete"](ab)})}function fW(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function gh(aa){if(!/^\d+\-./.test(aa)){return ii(iB)}var ac=aa.indexOf("-"),t=aa.substring(0,ac),ab=aa.substring(ac+1);return{prefix:parseInt(t,10),id:ab}}function ih(ad,aa){for(var ag=ad.start-ad.ids.length+1,t=ad.ids,ac=[t[0],aa,[]],ab=1,af=t.length;af>ab;ab++){ac=[t[ab],{status:"missing"},[ac]]}return[{pos:ag,ids:ac}]}function iy(ah,af){var ak,ac,aa,aj={status:"available"};if(ah._deleted&&(aj.deleted=!0),af){if(ah._id||(ah._id=fu()),ac=fu(32,16).toLowerCase(),ah._rev){if(aa=gh(ah._rev),aa.error){return aa}ah._rev_tree=[{pos:aa.prefix,ids:[aa.id,{status:"missing"},[[ac,aj,[]]]]}],ak=aa.prefix+1}else{ah._rev_tree=[{pos:1,ids:[ac,aj,[]]}],ak=1}}else{if(ah._revisions&&(ah._rev_tree=ih(ah._revisions,aj),ak=ah._revisions.start,ac=ah._revisions.ids[0]),!ah._rev_tree){if(aa=gh(ah._rev),aa.error){return aa}ak=aa.prefix,ac=aa.id,ah._rev_tree=[{pos:ak,ids:[ac,aj,[]]}]}}hs(ah._id),ah._rev=ak+"-"+ac;var ag={metadata:{},data:{}};for(var ad in ah){if(Object.prototype.hasOwnProperty.call(ah,ad)){var t="_"===ad[0];if(t&&!dn[ad]){var ab=ii(ei,ad);throw ab.message=ei.message+": "+ad,ab}t&&!hY[ad]?ag.metadata[ad.slice(1)]=ah[ad]:ag.data[ad]=ah[ad]}}return ag}function hH(t){for(var ab="",ac=new Uint8Array(t),aa=ac.byteLength,ad=0;aa>ad;ad++){ab+=String.fromCharCode(ac[ad])}return ab}function ci(t){return h3(hH(t))}function gI(t,ab){t=t||[],ab=ab||{};try{return new Blob(t,ab)}catch(ac){if("TypeError"!==ac.name){throw ac}for(var aa="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,ad=new aa,af=0;af<t.length;af+=1){ad.append(t[af])}return ad.getBlob(ab.type)}}function g5(t){for(var ab=t.length,ac=new ArrayBuffer(ab),aa=new Uint8Array(ac),ad=0;ab>ad;ad++){aa[ad]=t.charCodeAt(ad)}return ac}function fh(t,aa){return gI([g5(t)],{type:aa})}function dt(t,aa){return fh(fo(t),aa)}function a8(aa,ac){if("undefined"==typeof FileReader){return ac(hH((new FileReaderSync).readAsArrayBuffer(aa)))}var t=new FileReader,ab="function"==typeof t.readAsBinaryString;t.onloadend=function(af){var ad=af.target.result||"";return ab?ac(ad):void ac(hH(ad))},ab?t.readAsBinaryString(aa):t.readAsArrayBuffer(aa)}function i3(t,aa){a8(t,function(ab){aa(h3(ab))})}function a7(t,aa){if("undefined"==typeof FileReader){return aa((new FileReaderSync).readAsArrayBuffer(t))}var ab=new FileReader;ab.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);aa(ac)},ab.readAsArrayBuffer(t)}function jD(t){return h3(t)}function fa(aa,ac,t,ab){(t>0||ab<ac.byteLength)&&(ac=new Uint8Array(ac,t,Math.min(ab,ac.byteLength)-t)),aa.append(ac)}function gd(aa,ac,t,ab){(t>0||ab<ac.length)&&(ac=ac.substring(t,ab)),aa.appendBinary(ac)}function y(ah,af){function ak(){var aq=ad*aj,al=aq+aj;if(ad++,ag>ad){ab(t,ah,aq,al),gT(ak)}else{ab(t,ah,aq,al);var ap=t.end(!0),am=jD(ap);af(am),t.destroy()}}var ac="string"==typeof ah,aa=ac?ah.length:ah.byteLength,aj=Math.min(iU,aa),ag=Math.ceil(aa/aj),ad=0,t=ac?new hx:new hx.ArrayBuffer,ab=ac?gd:fa;ak()}function O(t){return hx.hash(t)}function z(ag,af,t){function ad(al){try{return fo(al)}catch(aj){var ak=ii(ik,"Attachment is not a valid base64 string");return{error:ak}}}function ab(aj,ak){if(aj.stub){return ak()}if("string"==typeof aj.data){var al=ad(aj.data);if(al.error){return ak(al.error)}aj.length=al.length,"blob"===af?aj.data=fh(al,aj.content_type):"base64"===af?aj.data=h3(al):aj.data=al,y(al,function(am){aj.digest="md5-"+am,ak()})}else{a7(aj.data,function(am){"binary"===af?aj.data=hH(am):"base64"===af&&(aj.data=ci(am)),y(am,function(ap){aj.digest="md5-"+ap,aj.length=am.byteLength,ak()})})}}function aa(){ah++,ag.length===ah&&(ac?t(ac):t())}if(!ag.length){return t()}var ac,ah=0;ag.forEach(function(ak){function am(aq){ac=aq,al++,al===aj.length&&aa()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return aa()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&ab(ak.data._attachments[ap],am)}})}function hq(aA,aa,ak,ah,ag,ax,ab,az){if(jg(aa.rev_tree,ak.metadata.rev)){return ah[ag]=ak,ax()}var ac=aa.winningRev||g0(aa),au="deleted" in aa?aa.deleted:jo(aa,ac),aj="deleted" in ak.metadata?ak.metadata.deleted:jo(ak.metadata),aq=/^1-/.test(ak.metadata.rev);if(au&&!aj&&az&&aq){var am=ak.data;am._rev=ac,am._id=ak.metadata.id,ak=iy(am,az)}var ay=g(aa.rev_tree,ak.metadata.rev_tree[0],aA),t=az&&(au&&aj||!au&&"new_leaf"!==ay.conflicts||au&&!aj&&"new_branch"===ay.conflicts);if(t){var av=ii(g3);return ah[ag]=av,ax()}var aw=ak.metadata.rev;ak.metadata.rev_tree=ay.tree,ak.stemmedRevs=ay.stemmedRevs||[],aa.rev_map&&(ak.metadata.rev_map=aa.rev_map);var af,al=g0(ak.metadata),ap=jo(ak.metadata,al),ad=au===ap?0:ap>au?-1:1;af=aw===al?ap:jo(ak.metadata,aw),ab(ak,al,ap,af,!0,ad,ag,ax)}function I(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function hL(aa,aq,aj,ah,am,af,ac,ak,t){function ap(aC,aw,aA){var av=g0(aC.metadata),ay=jo(aC.metadata,av);if("was_delete" in ak&&ay){return af[aw]=ii(h5,"deleted"),aA()}var ax=al&&I(aC);if(ax){var az=ii(g3);return af[aw]=az,aA()}var aB=ay?0:1;ac(aC,av,ay,ay,!1,aB,aw,aA)}function ab(){++au===ag&&t&&t()}aa=aa||1000;var al=ak.new_edits,ad=new hK.Map,au=0,ag=aq.length;aq.forEach(function(ay,aw){if(ay._id&&ex(ay._id)){var av=ay._deleted?"_removeLocal":"_putLocal";return void aj[av](ay,{ctx:am},function(aA,az){af[aw]=aA||az,ab()})}var ax=ay.metadata.id;ad.has(ax)?(ag--,ad.get(ax).push([ay,aw])):ad.set(ax,[[ay,aw]])}),ad.forEach(function(aw,ay){function az(){++ax<aw.length?av():ab()}function av(){var aC=aw[ax],aA=aC[0],aB=aC[1];if(ah.has(ay)){hq(aa,ah.get(ay),aA,af,aB,az,ac,al)}else{var aD=g([],aA.metadata.rev_tree[0],aa);aA.metadata.rev_tree=aD.tree,aA.stemmedRevs=aD.stemmedRevs||[],ap(aA,aB,az)}}var ax=0;av()})}function js(t){try{return JSON.parse(t)}catch(aa){return i8.parse(t)}}function gy(t){return t.length<50000?JSON.parse(t):js(t)}function Y(t){try{return JSON.stringify(t)}catch(aa){return i8.stringify(t)}}function S(t,ab,ac,aa){try{t.apply(ab,ac)}catch(ad){aa.emit("error",ad)}}function ib(t){if(!iR.running&&iR.queue.length){iR.running=!0;var aa=iR.queue.shift();aa.action(function(ac,ab){S(aa.callback,this,[ac,ab],t),iR.running=!1,iC.nextTick(function(){ib(t)})})}}function i2(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(ii(gx,aa,ab.type))}}function hf(t,aa,ab){return{data:Y(t),winningRev:aa,deletedOrLocal:ab?"1":"0",seq:t.seq,id:t.id}}function H(t){if(!t){return null}var aa=gy(t.data);return aa.winningRev=t.winningRev,aa.deleted="1"===t.deletedOrLocal,aa.seq=t.seq,aa}function Z(t){if(!t){return t}var aa=t._doc_id_rev.lastIndexOf(":");return t._id=t._doc_id_rev.substring(0,aa-1),t._rev=t._doc_id_rev.substring(aa+1),delete t._doc_id_rev,t}function ja(aa,ac,t,ab){t?ab(aa?"string"!=typeof aa?aa:dt(aa,ac):gI([""],{type:ac})):aa?"string"!=typeof aa?a8(aa,function(ad){ab(h3(ad))}):ab(aa):ab("")}function hN(ag,af,t,ad){function ab(){++ah===ac.length&&ad&&ad()}function aa(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=t.objectStore(ft).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,ab()}}var ac=Object.keys(ag._attachments||{});if(!ac.length){return ad&&ad()}var ah=0;ac.forEach(function(aj){af.attachments&&af.include_docs?aa(ag,aj):(ag._attachments[aj].stub=!0,ab())})}function iJ(t,aa){return gi.all(t.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return gi.all(ab.map(function(ah){var af=ac.doc._attachments[ah];if("body" in af){var ad=af.body,ag=af.content_type;return new gi(function(aj){ja(ad,ag,aa,function(ak){ac.doc._attachments[ah]=hI.extend(fc(af,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function ix(ah,af,ak){function ac(){ab--,ab||aa()}function aa(){aj.length&&aj.forEach(function(am){var al=t.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::￿",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||ad["delete"](am)}})}var aj=[],ag=ak.objectStore(gv),ad=ak.objectStore(ft),t=ak.objectStore(hV),ab=ah.length;ah.forEach(function(al){var am=ag.index("_doc_id_rev"),ap=af+"::"+al;am.getKey(ap).onsuccess=function(aq){var au=aq.target.result;if("number"!=typeof au){return ac()}ag["delete"](au);var av=t.index("seq").openCursor(IDBKeyRange.only(au));av.onsuccess=function(ay){var aw=ay.target.result;if(aw){var ax=aw.value.digestSeq.split("::")[0];aj.push(ax),t["delete"](aw.primaryKey),aw["continue"]()}else{ac()}}}})}function jA(aa,ac,t){try{return{txn:aa.transaction(ac,t)}}catch(ab){return{error:ab}}}function jk(aJ,aD,av,aI,ap,ax,ay){function am(){var aN=[h8,gv,ft,hJ,hV],aO=jA(ap,aN,"readwrite");return aO.error?ay(aO.error):(al=aO.txn,al.onabort=i2(ay),al.ontimeout=i2(ay),al.oncomplete=aj,ag=al.objectStore(h8),ah=al.objectStore(gv),aB=al.objectStore(ft),aE=al.objectStore(hV),void aM(function(aP){return aP?(t=!0,ay(aP)):void aL()}))}function aH(){hL(aJ.revs_limit,aq,aI,aa,al,ac,aF,av)}function aL(){function aR(){++aP===aq.length&&aH()}function aT(aU){var aV=H(aU.target.result);aV&&aa.set(aV.id,aV),aR()}if(aq.length){for(var aP=0,aS=0,aQ=aq.length;aQ>aS;aS++){var aN=aq[aS];if(aN._id&&ex(aN._id)){aR()}else{var aO=ag.get(aN.metadata.id);aO.onsuccess=aT}}}}function aj(){t||(ax.notify(aI._meta.name),aI._meta.docCount+=aA,ay(null,ac))}function au(aO,aP){var aN=aB.get(aO);aN.onsuccess=function(aQ){if(aQ.target.result){aP()}else{var aR=ii(i4,"unknown stub attachment with digest "+aO);aR.status=412,aP(aR)}}}function aM(aP){function aR(){++aO===aN.length&&aP(aQ)}var aN=[];if(aq.forEach(function(aS){aS.data&&aS.data._attachments&&Object.keys(aS.data._attachments).forEach(function(aT){var aU=aS.data._attachments[aT];aU.stub&&aN.push(aU.digest)})}),!aN.length){return aP()}var aQ,aO=0;aN.forEach(function(aS){au(aS,function(aT){aT&&!aQ&&(aQ=aT),aR()})})}function aF(aQ,aW,aS,aU,aT,aR,aO,aV){aA+=aR,aQ.metadata.winningRev=aW,aQ.metadata.deleted=aS;var aN=aQ.data;aN._id=aQ.metadata.id,aN._rev=aQ.metadata.rev,aU&&(aN._deleted=!0);var aP=aN._attachments&&Object.keys(aN._attachments).length;return aP?aG(aQ,aW,aS,aT,aO,aV):void ad(aQ,aW,aS,aT,aO,aV)}function ad(aP,aW,aU,aV,aS,aY){function aQ(bb){var aZ=aP.stemmedRevs||[];aV&&aI.auto_compaction&&(aZ=aZ.concat(g6(aP.metadata))),aZ&&aZ.length&&ix(aZ,aP.metadata.id,al),aT.seq=bb.target.result,delete aT.rev;var ba=hf(aT,aW,aU),bc=ag.put(ba);bc.onsuccess=aN}function aX(ba){ba.preventDefault(),ba.stopPropagation();var bb=ah.index("_doc_id_rev"),aZ=bb.getKey(aR._doc_id_rev);aZ.onsuccess=function(bc){var bd=ah.put(aR,bc.target.result);bd.onsuccess=aQ}}function aN(){ac[aS]={ok:!0,id:aT.id,rev:aW},aa.set(aP.metadata.id,aP.metadata),az(aP,aT.seq,aY)}var aR=aP.data,aT=aP.metadata;aR._doc_id_rev=aT.id+"::"+aT.rev,delete aR._id,delete aR._rev;var aO=ah.put(aR);aO.onsuccess=aQ,aO.onerror=aX}function aG(aP,aW,aS,aU,aT,aR){function aN(){aO===aQ.length&&ad(aP,aW,aS,aU,aT,aR)}function aV(){aO++,aN()}var aX=aP.data,aO=0,aQ=Object.keys(aX._attachments);aQ.forEach(function(aY){var bb=aP.data._attachments[aY];if(bb.stub){aO++,aN()}else{var aZ=bb.data;delete bb.data,bb.revpos=parseInt(aW,10);var ba=bb.digest;aC(ba,aZ,aV)}})}function az(aN,aQ,aT){function aO(){++aR===aS.length&&aT()}function aU(aW){var aX=aN.data._attachments[aW].digest,aV=aE.put({seq:aQ,digestSeq:aX+"::"+aQ});aV.onsuccess=aO,aV.onerror=function(aY){aY.preventDefault(),aY.stopPropagation(),aO()}}var aR=0,aS=Object.keys(aN.data._attachments||{});if(!aS.length){return aT()}for(var aP=0;aP<aS.length;aP++){aU(aS[aP])}}function aC(aO,aQ,aN){var aP=aB.count(aO);aP.onsuccess=function(aR){var aU=aR.target.result;if(aU){return aN()}var aS={digest:aO,body:aQ},aT=aB.put(aS);aT.onsuccess=aN}}for(var al,ag,ah,aB,aE,aw,aq=aD.docs,aA=0,ak=0,af=aq.length;af>ak;ak++){var ab=aq[ak];ab._id&&ex(ab._id)||(ab=aq[ak]=iy(ab,av.new_edits),ab.error&&!aw&&(aw=ab))}if(aw){return ay(aw)}var ac=new Array(aq.length),aa=new hK.Map,t=!1,aK=aI._meta.blobSupport?"blob":"base64";z(aq,aK,function(aN){return aN?ay(aN):void am()})}function hW(t,ab,ac,aa,ad){try{if(t&&ab){return ad?IDBKeyRange.bound(ab,t,!ac,!1):IDBKeyRange.bound(t,ab,!1,!ac)}if(t){return ad?IDBKeyRange.upperBound(t):IDBKeyRange.lowerBound(t)}if(ab){return ad?IDBKeyRange.lowerBound(ab,!ac):IDBKeyRange.upperBound(ab,!ac)}if(aa){return IDBKeyRange.only(aa)}}catch(af){return{error:af}}return null}function jn(aa,ac,t,ab){return"DataError"===t.name&&0===t.code?ab(null,{total_rows:aa._meta.docCount,offset:ac.skip,rows:[]}):void ab(ii(gx,t.name,t.message))}function hv(t,ab,ac,aa){function ad(aB,ah){function aG(aK,aL,aN){var aM=aK.id+"::"+aN;aF.get(aM).onsuccess=function(aO){aL.doc=Z(aO.target.result),aB.conflicts&&(aL.doc._conflicts=gk(aK)),hN(aL.doc,aB,al)}}function av(aO,aM,aN){var aK={id:aN.id,key:aN.id,value:{rev:aM}},aL=aN.deleted;if("ok"===aB.deleted){ap.push(aK),aL?(aK.value.deleted=!0,aK.doc=null):aB.include_docs&&aG(aN,aK,aM)}else{if(!aL&&aw--<=0&&(ap.push(aK),aB.include_docs&&aG(aN,aK,aM),0===--aH)){return}}aO["continue"]()}function au(aN){ag=ab._meta.docCount;var aL=aN.target.result;if(aL){var aK=H(aL.value),aM=aK.winningRev;av(aL,aM,aK)}}function ak(){ah(null,{total_rows:ag,offset:aB.skip,rows:ap})}function aj(){aB.attachments?iJ(ap,aB.binary).then(ak):ak()}var aC="startkey" in aB?aB.startkey:!1,aE="endkey" in aB?aB.endkey:!1,ay="key" in aB?aB.key:!1,aw=aB.skip||0,aH="number"==typeof aB.limit?aB.limit:-1,aq=aB.inclusive_end!==!1,aD="descending" in aB&&aB.descending?"prev":null,ax=hW(aC,aE,aq,ay,aD);if(ax&&ax.error){return jn(ab,aB,ax.error,ah)}var aA=[h8,gv];aB.attachments&&aA.push(ft);var am=jA(ac,aA,"readonly");if(am.error){return ah(am.error)}var al=am.txn,az=al.objectStore(h8),aI=al.objectStore(gv),aJ=aD?az.openCursor(ax,aD):az.openCursor(ax),aF=aI.index("_doc_id_rev"),ap=[],ag=0;al.oncomplete=aj,aJ.onsuccess=au}function af(ag,ah){return 0===ag.limit?ah(null,{total_rows:ab._meta.docCount,offset:ag.skip,rows:[]}):void ad(ag,ah)}af(t,aa)}function hz(t){return new gi(function(ab){var aa=gI([""]);t.objectStore(iH).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function bn(t,aa){var ab=this;iR.queue.push({action:function(ac){jq(ab,t,ac)},callback:aa}),ib(ab.constructor)}function jq(ab,aa,al){function aj(au){var av=au.createObjectStore(h8,{keyPath:"id"});au.createObjectStore(gv,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),au.createObjectStore(ft,{keyPath:"digest"}),au.createObjectStore(a6,{keyPath:"id",autoIncrement:!1}),au.createObjectStore(iH),av.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.createObjectStore(hJ,{keyPath:"_id"});var aw=au.createObjectStore(hV,{autoIncrement:!0});aw.createIndex("seq","seq"),aw.createIndex("digestSeq","digestSeq",{unique:!0})}function ah(au,av){var aw=au.objectStore(h8);aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),aw.openCursor().onsuccess=function(ay){var aA=ay.target.result;if(aA){var az=aA.value,ax=jo(az);az.deletedOrLocal=ax?"1":"0",aw.put(az),aA["continue"]()}else{av()}}}function am(au){au.createObjectStore(hJ,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function ac(aw,az){var av=aw.objectStore(hJ),ay=aw.objectStore(h8),ax=aw.objectStore(gv),au=ay.openCursor();au.onsuccess=function(aE){var aH=aE.target.result;if(aH){var aB=aH.value,aK=aB.id,aL=ex(aK),aC=g0(aB);if(aL){var aF=aK+"::"+aC,aI=aK+"::",aD=aK+"::~",aG=ax.index("_doc_id_rev"),aJ=IDBKeyRange.bound(aI,aD,!1,!1),aA=aG.openCursor(aJ);aA.onsuccess=function(aN){if(aA=aN.target.result){var aM=aA.value;aM._doc_id_rev===aF&&av.put(aM),ax["delete"](aA.primaryKey),aA["continue"]()}else{ay["delete"](aH.primaryKey),aH["continue"]()}}}else{aH["continue"]()}}else{az&&az()}}}function ag(au){var av=au.createObjectStore(hV,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function af(aw,az){var av=aw.objectStore(gv),ay=aw.objectStore(ft),ax=aw.objectStore(hV),au=ay.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (av.openCursor().onsuccess=function(aC){var aG=aC.target.result;if(!aG){return az()}for(var aH=aG.value,aE=aG.primaryKey,aK=Object.keys(aH._attachments||{}),aI={},aJ=0;aJ<aK.length;aJ++){var aL=aH._attachments[aK[aJ]];aI[aL.digest]=!0}var aD=Object.keys(aI);for(aJ=0;aJ<aD.length;aJ++){var aF=aD[aJ];ax.put({seq:aE,digestSeq:aF+"::"+aE})}aG["continue"]()}):az()}}function aq(au){function ay(az){return az.data?H(az):(az.deleted="1"===az.deletedOrLocal,az)}var av=au.objectStore(gv),aw=au.objectStore(h8),ax=aw.openCursor();ax.onsuccess=function(aC){function aB(){var aF=aD.id+"::",aH=aD.id+"::￿",aG=av.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return aD.seq=aE,az()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function az(){var aE=hf(aD,aD.winningRev,aD.deleted),aF=aw.put(aE);aF.onsuccess=function(){aA["continue"]()}}var aA=aC.target.result;if(aA){var aD=ay(aA.value);return aD.winningRev=aD.winningRev||g0(aD),aD.seq?az():void aB()}}}var ak=aa.name,ap=null;ab._meta=null,ab.type=function(){return"idb"},ab._id=er(function(au){au(null,ab._meta.instanceId)}),ab._bulkDocs=function(aw,av,au){jk(aa,aw,av,ab,ap,B,au)},ab._get=function(aB,ax,ay){function au(){ay(aA,{doc:aC,metadata:av,ctx:aw})}var aC,av,aA,aw=ax.ctx;if(!aw){var az=jA(ap,[h8,gv,ft],"readonly");if(az.error){return ay(az.error)}aw=az.txn}aw.objectStore(h8).get(aB).onsuccess=function(aG){if(av=H(aG.target.result),!av){return aA=ii(h5,"missing"),au()}if(jo(av)&&!ax.rev){return aA=ii(h5,"deleted"),au()}var aE=aw.objectStore(gv),aD=ax.rev||av.winningRev,aF=av.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return aC=aH.target.result,aC&&(aC=Z(aC)),aC?void au():(aA=ii(h5,"missing"),au())}}},ab._getAttachment=function(aB,ax,ay,au,aC){var av;if(au.ctx){av=au.ctx}else{var aA=jA(ap,[h8,gv,ft],"readonly");if(aA.error){return aC(aA.error)}av=aA.txn}var aw=ay.digest,az=ay.content_type;av.objectStore(ft).get(aw).onsuccess=function(aE){var aD=aE.target.result.body;ja(aD,az,au.binary,function(aF){aC(null,aF)})}},ab._info=function(av){if(null===ap||!a2.has(ak)){var aA=new Error("db isn't open");return aA.id="idbNull",av(aA)}var au,ay,ax=jA(ap,[gv],"readonly");if(ax.error){return av(ax.error)}var aw=ax.txn,az=aw.objectStore(gv).openCursor(null,"prev");az.onsuccess=function(aB){var aC=aB.target.result;au=aC?aC.key:0,ay=ab._meta.docCount},aw.oncomplete=function(){av(null,{doc_count:ay,update_seq:au,idb_attachment_format:ab._meta.blobSupport?"binary":"base64"})}},ab._allDocs=function(av,au){hv(av,ab,ap,au)},ab._changes=function(av){function aJ(aS){function aM(){return aN.seq!==aR?aS["continue"]():(aA=aR,aN.winningRev===aQ._rev?aO(aQ):void aP())}function aP(){var aU=aQ._id+"::"+aN.winningRev,aT=aH.get(aU);aT.onsuccess=function(aV){aO(Z(aV.target.result))}}function aO(aU){var aT=av.processChange(aU,aN,av);aT.seq=aN.seq;var aV=aE(aT);return"object"==typeof aV?av.complete(aV):(aV&&(aK++,aD&&aF.push(aT),av.attachments&&av.include_docs?hN(aU,av,az,function(){iJ([aT],av.binary).then(function(){av.onChange(aT)})}):av.onChange(aT)),void (aK!==ax&&aS["continue"]()))}var aQ=Z(aS.value),aR=aS.key;if(aB&&!aB.has(aQ._id)){return aS["continue"]()}var aN;return(aN=ay.get(aQ._id))?aM():void (au.get(aQ._id).onsuccess=function(aT){aN=H(aT.target.result),ay.set(aQ._id,aN),aM()})}function aC(aN){var aM=aN.target.result;aM&&aJ(aM)}function aw(){var aM=[h8,gv];av.attachments&&aM.push(ft);var aN=jA(ap,aM,"readonly");if(aN.error){return av.complete(aN.error)}az=aN.txn,az.onabort=i2(av.complete),az.oncomplete=aI,aG=az.objectStore(gv),au=az.objectStore(h8),aH=aG.index("_doc_id_rev");var aO;aO=av.descending?aG.openCursor(null,"prev"):aG.openCursor(IDBKeyRange.lowerBound(av.since,!0)),aO.onsuccess=aC}function aI(){function aM(){av.complete(null,{results:aF,last_seq:aA})}!av.continuous&&av.attachments?iJ(aF).then(aM):aM()}if(av=g9(av),av.continuous){var aL=ak+":"+fu();return B.addListener(ak,aL,ab,av),B.notify(ak),{cancel:function(){B.removeListener(ak,aL)}}}var aB=av.doc_ids&&new hK.Set(av.doc_ids);av.since=av.since||0;var aA=av.since,ax="limit" in av?av.limit:-1;0===ax&&(ax=1);var aD;aD="return_docs" in av?av.return_docs:"returnDocs" in av?av.returnDocs:!0;var az,aG,au,aH,aF=[],aK=0,aE=jB(av),ay=new hK.Map;aw()},ab._close=function(au){return null===ap?au(ii(h7)):(ap.close(),a2["delete"](ak),ap=null,void au())},ab._getRevisionTree=function(au,ay){var av=jA(ap,[h8],"readonly");if(av.error){return ay(av.error)}var aw=av.txn,ax=aw.objectStore(h8).get(au);ax.onsuccess=function(aA){var az=H(aA.target.result);az?ay(null,az.rev_tree):ay(ii(h5))}},ab._doCompaction=function(aA,av,ay){var az=[h8,gv,ft,hV],au=jA(ap,az,"readwrite");if(au.error){return ay(au.error)}var ax=au.txn,aw=ax.objectStore(h8);aw.get(aA).onsuccess=function(aC){var aE=H(aC.target.result);a3(aE.rev_tree,function(aF,aJ,aG,aK,aH){var aI=aJ+"-"+aG;-1!==av.indexOf(aI)&&(aH.status="missing")}),ix(av,aA,ax);var aD=aE.winningRev,aB=aE.deleted;ax.objectStore(h8).put(hf(aE,aD,aB))},ax.onabort=i2(ay),ax.oncomplete=function(){ay()}},ab._getLocal=function(au,ay){var av=jA(ap,[hJ],"readonly");if(av.error){return ay(av.error)}var aw=av.txn,ax=aw.objectStore(hJ).get(au);ax.onerror=i2(ay),ax.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,ay(null,az)):ay(ii(h5))}},ab._putLocal=function(aD,ay,aA){"function"==typeof ay&&(aA=ay,ay={}),delete aD._revisions;var av=aD._rev,au=aD._id;av?aD._rev="0-"+(parseInt(av.split("-")[1],10)+1):aD._rev="0-1";var aw,aB=ay.ctx;if(!aB){var ax=jA(ap,[hJ],"readwrite");if(ax.error){return aA(ax.error)}aB=ax.txn,aB.onerror=i2(aA),aB.oncomplete=function(){aw&&aA(null,aw)}}var az,aC=aB.objectStore(hJ);av?(az=aC.get(au),az.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===av){var aG=aC.put(aD);aG.onsuccess=function(){aw={ok:!0,id:aD._id,rev:aD._rev},ay.ctx&&aA(null,aw)}}else{aA(ii(g3))}}):(az=aC.add(aD),az.onerror=function(aE){aA(ii(g3)),aE.preventDefault(),aE.stopPropagation()},az.onsuccess=function(){aw={ok:!0,id:aD._id,rev:aD._rev},ay.ctx&&aA(null,aw)})},ab._removeLocal=function(aB,ax,ay){"function"==typeof ax&&(ay=ax,ax={});var au=ax.ctx;if(!au){var aC=jA(ap,[hJ],"readwrite");if(aC.error){return ay(aC.error)}au=aC.txn,au.oncomplete=function(){av&&ay(null,av)}}var av,aA=aB._id,aw=au.objectStore(hJ),az=aw.get(aA);az.onerror=i2(ay),az.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===aB._rev?(aw["delete"](aA),av={ok:!0,id:aA,rev:"0-0"},ax.ctx&&ay(null,av)):ay(ii(h5))}},ab._destroy=function(ax,av){B.removeAllListeners(ak);var aw=J.get(ak);aw&&aw.result&&(aw.result.close(),a2["delete"](ak));var au=indexedDB.deleteDatabase(ak);au.onsuccess=function(){J["delete"](ak),ga()&&ak in localStorage&&delete localStorage[ak],av(null,{ok:!0})},au.onerror=i2(av)};var ad=a2.get(ak);if(ad){return ap=ad.idb,ab._meta=ad.global,void iC.nextTick(function(){al(null,ab)})}var t;t=aa.storage?jy(ak,aa.storage):indexedDB.open(ak,g2),J.set(ak,t),t.onupgradeneeded=function(az){function aw(){var aA=ax[au-1];au++,aA&&aA(av,aw)}var ay=az.target.result;if(az.oldVersion<1){return aj(ay)}var av=az.currentTarget.transaction;az.oldVersion<3&&am(ay),az.oldVersion<4&&ag(ay);var ax=[ah,ac,af,aq],au=az.oldVersion;aw()},t.onsuccess=function(ay){ap=ay.target.result,ap.onversionchange=function(){ap.close(),a2["delete"](ak)},ap.onabort=function(aA){iO("error","Database has a global failure",aA.target.error),ap.close(),a2["delete"](ak)};var av=ap.transaction([a6,iH,h8],"readwrite"),ax=av.objectStore(a6).get(a6),az=null,aw=null,au=null;ax.onsuccess=function(aB){var aD=function(){null!==az&&null!==aw&&null!==au&&(ab._meta={name:ak,instanceId:au,blobSupport:az,docCount:aw},a2.set(ak,{idb:ap,global:ab._meta}),al(null,ab))},aA=aB.target.result||{id:a6};ak+"_id" in aA?(au=aA[ak+"_id"],aD()):(au=fu(),aA[ak+"_id"]=au,av.objectStore(a6).put(aA).onsuccess=function(){aD()}),iX||(iX=hz(av)),iX.then(function(aE){az=aE,aD()});var aC=av.objectStore(h8).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){aw=aE.target.result,aD()}}},t.onerror=function(){var au="Failed to open indexedDB, are you in private browsing mode?";iO("error",au),al(ii(gx,au))}}function jy(t,aa){try{return indexedDB.open(t,{version:g2,storage:aa})}catch(ab){return indexedDB.open(t,g2)}}function ji(t){t.adapter("idb",bn,!0)}function jh(t){return decodeURIComponent(escape(t))}function gj(t){return 65>t?t-48:t-55}function iI(aa,ac,t){for(var ab="";t>ac;){ab+=String.fromCharCode(gj(aa.charCodeAt(ac++))<<4|gj(aa.charCodeAt(ac++)))}return ab}function it(aa,ac,t){for(var ab="";t>ac;){ab+=String.fromCharCode(gj(aa.charCodeAt(ac+2))<<12|gj(aa.charCodeAt(ac+3))<<8|gj(aa.charCodeAt(ac))<<4|gj(aa.charCodeAt(ac+1))),ac+=4}return ab}function hX(t,aa){return"UTF-8"===aa?jh(iI(t,0,t.length)):it(t,0,t.length)}function jc(t){return"'"+t+"'"}function jf(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function gn(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function jx(t){return delete t._id,delete t._rev,JSON.stringify(t)}function hT(t,aa,ab){return t=JSON.parse(t),t._id=aa,t._rev=ab,t}function hQ(t){for(var aa="(";t--;){aa+="?",t&&(aa+=",")}return aa+")"}function hk(t,ab,ac,aa,ad){return"SELECT "+t+" FROM "+("string"==typeof ab?ab:ab.join(" JOIN "))+(ac?" ON "+ac:"")+(aa?" WHERE "+("string"==typeof aa?aa:aa.join(" AND ")):"")+(ad?" ORDER BY "+ad:"")}function jv(ad,aa,ag){function t(){++ab===ad.length&&ac()}function ac(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+i0+" WHERE seq IN "+hQ(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+i0+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(aq){var au="SELECT digest FROM "+i0+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";aq.executeSql(au,aj,function(ax,aw){for(var ay=new hK.Set,av=0;av<aw.rows.length;av++){ay.add(aw.rows.item(av).digest)}aj.forEach(function(az){ay.has(az)||(ax.executeSql("DELETE FROM "+i0+" WHERE digest=?",[az]),ax.executeSql("DELETE FROM "+iw+" WHERE digest=?",[az]))})})})}})}}if(ad.length){var ab=0,af=[];ad.forEach(function(ah){var aj="SELECT seq FROM "+il+" WHERE doc_id=? AND rev=?";ag.executeSql(aj,[aa,ah],function(al,am){if(!am.rows.length){return t()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+il+" WHERE seq=?",[ak],t)})})}}function gr(t){return function(ad){iO("error","WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(ii(gL,ab,ac))}}function id(t){if("size" in t){return 1000000*t.size}var aa="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return aa?5000000:1}function ig(ab,ad,ax,aB,az,aw,aj){function au(){return ac?aj(ac):(aw.notify(aB._name),aB._docCount=-1,void aj(null,ah))}function af(aD,aE){var aC="SELECT count(*) as cnt FROM "+iw+" WHERE digest=?";ap.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=ii(i4,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function t(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(aq.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){af(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function aA(aH,aO,aE,aJ,aL,aC,aM,aP){function aF(){function aX(bc,ba){function bb(){return ++bf===bg.length&&ba(),!1}function aZ(bh){var bj="INSERT INTO "+i0+" (digest, seq) VALUES (?,?)",bi=[aY._attachments[bh].digest,bc];ap.executeSql(bj,bi,bb,bb)}var bf=0,bg=Object.keys(aY._attachments||{});if(!bg.length){return ba()}for(var bd=0;bd<bg.length;bd++){aZ(bg[bd])}}var aY=aH.data,aV=aJ?1:0,aS=aY._id,aW=aY._rev,aU=jx(aY),aT="INSERT INTO "+il+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aR=[aS,aW,aU,aV];ap.executeSql(aT,aR,function(aZ,ba){var bb=ba.insertId;aX(bb,function(){aG(aZ,bb)})},function(){var aZ=hk("seq",il,null,"doc_id=? AND rev=?");return ap.executeSql(aZ,[aS,aW],function(bb,bf){var bd=bf.rows.item(0).seq,bc="UPDATE "+il+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",ba=[aU,aV,aS,aW];bb.executeSql(bc,ba,function(bg){aX(bd,function(){aG(bg,bd)})})}),!1})}function aI(aR){aK||(aR?(aK=aR,aP(aK)):aQ===aD.length&&aF())}function aN(aR){aQ++,aI(aR)}function aG(aT,aU){var aR=aH.metadata.id,aS=aH.stemmedRevs||[];aL&&aB.auto_compaction&&(aS=g6(aH.metadata).concat(aS)),aS.length&&jv(aS,aR,aT),aH.metadata.seq=aU,delete aH.metadata.rev;var aX=aL?"UPDATE "+hm+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+il+" WHERE doc_id="+hm+".id AND rev=?) WHERE id=?":"INSERT INTO "+hm+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aW=Y(aH.metadata),aV=aL?[aW,aU,aO,aR]:[aR,aU,aU,aW];aT.executeSql(aX,aV,function(){ah[aM]={ok:!0,id:aH.metadata.id,rev:aO},am.set(aR,aH.metadata),aP()})}var aK=null,aQ=0;aH.data._id=aH.metadata.id,aH.data._rev=aH.metadata.rev;var aD=Object.keys(aH.data._attachments||{});aJ&&(aH.data._deleted=!0),aD.forEach(function(aS){var aU=aH.data._attachments[aS];if(aU.stub){aQ++,aI()}else{var aT=aU.data;delete aU.data,aU.revpos=parseInt(aO,10);var aR=aU.digest;ay(aR,aT,aN)}}),aD.length||aF()}function ak(){hL(ab.revs_limit,aq,aB,am,ap,ah,aA,ax)}function av(aD){function aE(){++aC===aq.length&&aD()}if(!aq.length){return aD()}var aC=0;aq.forEach(function(aG){if(aG._id&&ex(aG._id)){return aE()}var aF=aG.metadata.id;ap.executeSql("SELECT json FROM "+hm+" WHERE id = ?",[aF],function(aH,aI){if(aI.rows.length){var aJ=gy(aI.rows.item(0).json);am.set(aF,aJ)}aE()})})}function ay(aD,aF,aC){var aE="SELECT digest FROM "+iw+" WHERE digest=?";ap.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+iw+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,jf(aF)],function(){aC()},function(){return aC(),!1}))})}var al=ax.new_edits,ag=ad.docs,aq=ag.map(function(aC){if(aC._id&&ex(aC._id)){return aC}var aD=iy(aC,al);return aD}),aa=aq.filter(function(aC){return aC.error});if(aa.length){return aj(aa[0])}var ap,ac,ah=new Array(aq.length),am=new hK.Map;z(aq,"binary",function(aC){return aC?aj(aC):void az.transaction(function(aD){ap=aD,t(function(aE){aE?ac=aE:av(ak)})},gr(aj),au)})}function hD(t){return t.websql(t.name,t.version,t.description,t.size)}function i9(t){try{return{db:hD(t)}}catch(aa){return{error:aa}}}function gQ(t){var aa=fl.get(t.name);return aa||(aa=i9(t),fl.set(t.name,aa),aa.db&&(aa.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),aa}function iL(aj,ag,ac,af,ab){function aa(){++t===ad.length&&ab&&ab()}function ah(am,ak){var al=am._attachments[ak],ap={binary:ag.binary,ctx:af};ac._getAttachment(am._id,ak,al,ap,function(au,aq){am._attachments[ak]=hI.extend(fc(al,["digest","content_type"]),{data:aq}),aa()})}var ad=Object.keys(aj._attachments||{});if(!ad.length){return ab&&ab()}var t=0;ad.forEach(function(ak){ag.attachments&&ag.include_docs?ah(aj,ak):(aj._attachments[ak].stub=!0,aa())})}function hr(ap,aw){function aj(){ga()&&(window.localStorage["_pouch__websqldb_"+ab._name]=!0),aw(null,ab)}function av(aD,aE){aD.executeSql(f),aD.executeSql("ALTER TABLE "+il+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aD.executeSql(ie),aD.executeSql("ALTER TABLE "+hm+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aD.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+hm+" (local, id)");var aF="SELECT "+hm+".winningseq AS seq, "+hm+".json AS metadata FROM "+il+" JOIN "+hm+" ON "+il+".seq = "+hm+".winningseq";aD.executeSql(aF,[],function(aJ,aN){for(var aK=[],aH=[],aG=0;aG<aN.rows.length;aG++){var aM=aN.rows.item(aG),aL=aM.seq,aI=JSON.parse(aM.metadata);jo(aI)&&aK.push(aL),ex(aI.id)&&aH.push(aI.id)}aJ.executeSql("UPDATE "+hm+"SET local = 1 WHERE id IN "+hQ(aH.length),aH,function(){aJ.executeSql("UPDATE "+il+" SET deleted = 1 WHERE seq IN "+hQ(aK.length),aK,aE)})})})})}function aq(aE,aF){var aD="CREATE TABLE IF NOT EXISTS "+gq+" (id UNIQUE, rev, json)";aE.executeSql(aD,[],function(){var aG="SELECT "+hm+".id AS id, "+il+".json AS data FROM "+il+" JOIN "+hm+" ON "+il+".seq = "+hm+".winningseq WHERE local = 1";aE.executeSql(aG,[],function(aK,aI){function aL(){if(!aJ.length){return aF(aK)}var aM=aJ.shift(),aN=JSON.parse(aM.data)._rev;aK.executeSql("INSERT INTO "+gq+" (id, rev, json) VALUES (?,?,?)",[aM.id,aN,aM.data],function(aO){aO.executeSql("DELETE FROM "+hm+" WHERE id=?",[aM.id],function(aP){aP.executeSql("DELETE FROM "+il+" WHERE seq=?",[aM.seq],function(){aL()})})})}for(var aJ=[],aH=0;aH<aI.rows.length;aH++){aJ.push(aI.rows.item(aH))}aL()})})}function aB(aE,aG){function aD(aH){function aI(){if(!aH.length){return aG(aE)}var aL=aH.shift(),aN=hX(aL.hex,ay),aK=aN.lastIndexOf("::"),aM=aN.substring(0,aK),aO=aN.substring(aK+2),aJ="UPDATE "+il+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aE.executeSql(aJ,[aM,aO,aN],function(){aI()})}aI()}var aF="ALTER TABLE "+il+" ADD COLUMN doc_id";aE.executeSql(aF,[],function(aH){var aI="ALTER TABLE "+il+" ADD COLUMN rev";aH.executeSql(aI,[],function(aJ){aJ.executeSql(o,[],function(aK){var aL="SELECT hex(doc_id_rev) as hex FROM "+il;aK.executeSql(aL,[],function(aN,aP){for(var aO=[],aM=0;aM<aP.rows.length;aM++){aO.push(aP.rows.item(aM))}aD(aO)})})})})}function am(aE,aG){function aD(aI){var aH="SELECT COUNT(*) AS cnt FROM "+iw;aI.executeSql(aH,[],function(aM,aK){function aN(){var aP=hk(jb+", "+hm+".id AS id",[hm,il],p,null,hm+".id ");aP+=" LIMIT "+aJ+" OFFSET "+aO,aO+=aJ,aM.executeSql(aP,[],function(ba,aY){function aU(bc,bd){var bf=aW[bc]=aW[bc]||[];-1===bf.indexOf(bd)&&bf.push(bd)}if(!aY.rows.length){return aG(ba)}for(var aW={},aS=0;aS<aY.rows.length;aS++){for(var aZ=aY.rows.item(aS),aQ=hT(aZ.data,aZ.id,aZ.rev),aV=Object.keys(aQ._attachments||{}),aT=0;aT<aV.length;aT++){var aX=aQ._attachments[aV[aT]];aU(aX.digest,aZ.seq)}}var bb=[];if(Object.keys(aW).forEach(function(bc){var bd=aW[bc];bd.forEach(function(bf){bb.push([bc,bf])})}),!bb.length){return aN()}var aR=0;bb.forEach(function(bd){var bc="INSERT INTO "+i0+" (digest, seq) VALUES (?,?)";ba.executeSql(bc,bd,function(){++aR===bb.length&&aN()})})})}var aL=aK.rows.item(0).cnt;if(!aL){return aG(aM)}var aO=0,aJ=10;aN()})}var aF="CREATE TABLE IF NOT EXISTS "+i0+" (digest, seq INTEGER)";aE.executeSql(aF,[],function(aH){aH.executeSql(h6,[],function(aI){aI.executeSql(gH,[],aD)})})}function ah(aE,aF){var aD="ALTER TABLE "+iw+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aE.executeSql(aD,[],aF)}function ad(aE,aF){var aD="ALTER TABLE "+hm+" ADD COLUMN max_seq INTEGER";aE.executeSql(aD,[],function(aG){var aH="UPDATE "+hm+" SET max_seq=(SELECT MAX(seq) FROM "+il+" WHERE doc_id=id)";aG.executeSql(aH,[],function(aJ){var aI="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+hm+" (max_seq)";aJ.executeSql(aI,[],aF)})})}function ac(aD,aE){aD.executeSql('SELECT HEX("a") AS hex',[],function(aF,aH){var aG=aH.rows.item(0).hex;ay=2===aG.length?"UTF-8":"UTF-16",aE()})}function aa(){for(;aA.length>0;){var aD=aA.pop();aD(null,au)}}function ag(aK,aO){if(0===aO){var aF="CREATE TABLE IF NOT EXISTS "+T+" (dbid, db_version INTEGER)",aI="CREATE TABLE IF NOT EXISTS "+iw+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aL="CREATE TABLE IF NOT EXISTS "+i0+" (digest, seq INTEGER)",aN="CREATE TABLE IF NOT EXISTS "+hm+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aM="CREATE TABLE IF NOT EXISTS "+il+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aG="CREATE TABLE IF NOT EXISTS "+gq+" (id UNIQUE, rev, json)";aK.executeSql(aI),aK.executeSql(aG),aK.executeSql(aL,[],function(){aK.executeSql(gH),aK.executeSql(h6)}),aK.executeSql(aN,[],function(){aK.executeSql(f),aK.executeSql(aM,[],function(){aK.executeSql(ie),aK.executeSql(o),aK.executeSql(aF,[],function(){var aP="INSERT INTO "+T+" (db_version, dbid) VALUES (?,?)";au=fu();var aQ=[ff,au];aK.executeSql(aP,aQ,function(){aa()})})})})}else{var aE=function(){var aQ=ff>aO;aQ&&aK.executeSql("UPDATE "+T+" SET db_version = "+ff);var aP="SELECT dbid FROM "+T;aK.executeSql(aP,[],function(aR,aS){au=aS.rows.item(0).dbid,aa()})},aH=[av,aq,aB,am,ah,ad,aE],aJ=aO,aD=function(aP){aH[aJ-1](aP,aD),aJ++};aD(aK)}}function aC(){af.transaction(function(aD){ac(aD,function(){ak(aD)})},gr(aw),aj)}function ak(aD){var aE="SELECT sql FROM sqlite_master WHERE tbl_name = "+T;aD.executeSql(aE,[],function(aF,aG){aG.rows.length?/db_version/.test(aG.rows.item(0).sql)?aF.executeSql("SELECT db_version FROM "+T,[],function(aH,aI){var aJ=aI.rows.item(0).db_version;ag(aH,aJ)}):aF.executeSql("ALTER TABLE "+T+" ADD COLUMN db_version INTEGER",[],function(){ag(aF,1)}):ag(aF,0)})}function az(aE,aF){if(-1!==ab._docCount){return aF(ab._docCount)}var aD=hk("COUNT("+hm+".id) AS 'num'",[hm,il],p,il+".deleted=0");aE.executeSql(aD,[],function(aG,aH){ab._docCount=aH.rows.item(0).num,aF(ab._docCount)})}var ay,ab=this,au=null,ax=id(ap),aA=[];ab._docCount=-1,ab._name=ap.name;var al=hI.extend({},ap,{version:dr,description:ap.name,size:ax}),t=gQ(al);if(t.error){return gr(aw)(t.error)}var af=t.db;"function"!=typeof af.readTransaction&&(af.readTransaction=af.transaction),aC(),ab.type=function(){return"websql"},ab._id=er(function(aD){aD(null,au)}),ab._info=function(aD){af.readTransaction(function(aE){az(aE,function(aF){var aG="SELECT MAX(seq) AS seq FROM "+il;aE.executeSql(aG,[],function(aI,aH){var aJ=aH.rows.item(0).seq||0;aD(null,{doc_count:aF,update_seq:aJ,sqlite_plugin:af._sqlitePlugin,websql_encoding:ay})})})},gr(aD))},ab._bulkDocs=function(aF,aD,aE){ig(ap,aF,aD,ab,af,gS,aE)},ab._get=function(aJ,aI,aL){function aE(){aL(aG,{doc:aD,metadata:aK,ctx:aM})}var aD,aK,aG,aM=aI.ctx;if(!aM){return af.readTransaction(function(aN){ab._get(aJ,hI.extend({ctx:aN},aI),aL)})}var aF,aH;aI.rev?(aF=hk(jb,[hm,il],hm+".id="+il+".doc_id",[il+".doc_id=?",il+".rev=?"]),aH=[aJ,aI.rev]):(aF=hk(jb,[hm,il],p,hm+".id=?"),aH=[aJ]),aM.executeSql(aF,aH,function(aP,aO){if(!aO.rows.length){return aG=ii(h5,"missing"),aE()}var aN=aO.rows.item(0);return aK=gy(aN.metadata),aN.deleted&&!aI.rev?(aG=ii(h5,"deleted"),aE()):(aD=hT(aN.data,aK.id,aN.rev),void aE())})},ab._allDocs=function(aQ,aG){var aF,aM=[],aK="startkey" in aQ?aQ.startkey:!1,aP="endkey" in aQ?aQ.endkey:!1,aI="key" in aQ?aQ.key:!1,aE="descending" in aQ?aQ.descending:!1,aH="limit" in aQ?aQ.limit:-1,aJ="skip" in aQ?aQ.skip:0,aN=aQ.inclusive_end!==!1,aD=[],aL=[];if(aI!==!1){aL.push(hm+".id = ?"),aD.push(aI)}else{if(aK!==!1||aP!==!1){if(aK!==!1&&(aL.push(hm+".id "+(aE?"<=":">=")+" ?"),aD.push(aK)),aP!==!1){var aO=aE?">":"<";aN&&(aO+="="),aL.push(hm+".id "+aO+" ?"),aD.push(aP)}aI!==!1&&(aL.push(hm+".id = ?"),aD.push(aI))}}"ok"!==aQ.deleted&&aL.push(il+".deleted = 0"),af.readTransaction(function(aR){az(aR,function(aS){if(aF=aS,0!==aH){var aT=hk(jb,[hm,il],p,aL,hm+".id "+(aE?"DESC":"ASC"));aT+=" LIMIT "+aH+" OFFSET "+aJ,aR.executeSql(aT,aD,function(aZ,aW){for(var aX=0,bc=aW.rows.length;bc>aX;aX++){var ba=aW.rows.item(aX),aY=gy(ba.metadata),aU=aY.id,bb=hT(ba.data,aU,ba.rev),aV=bb._rev,bd={id:aU,key:aU,value:{rev:aV}};if(aQ.include_docs&&(bd.doc=bb,bd.doc._rev=aV,aQ.conflicts&&(bd.doc._conflicts=gk(aY)),iL(bd.doc,aQ,ab,aZ)),ba.deleted){if("ok"!==aQ.deleted){continue}bd.value.deleted=!0,bd.doc=null}aM.push(bd)}})}})},gr(aG),function(){aG(null,{total_rows:aF,offset:aQ.skip,rows:aM})})},ab._changes=function(aK){function aJ(){var aN=hm+".json AS metadata, "+hm+".max_seq AS maxSeq, "+il+".json AS winningDoc, "+il+".rev AS winningRev ",aM=hm+" JOIN "+il,aO=hm+".id="+il+".doc_id AND "+hm+".winningseq="+il+".seq",aP=["maxSeq > ?"],aR=[aK.since];aK.doc_ids&&(aP.push(hm+".id IN "+hQ(aK.doc_ids.length)),aR=aR.concat(aK.doc_ids));var aL="maxSeq "+(aF?"DESC":"ASC"),aS=hk(aN,aM,aO,aP,aL),aT=jB(aK);aK.view||aK.filter||(aS+=" LIMIT "+aI);var aQ=aK.since||0;af.readTransaction(function(aU){aU.executeSql(aS,aR,function(bd,bc){function aV(bg){return function(){aK.onChange(bg)}}for(var aY=0,ba=bc.rows.length;ba>aY;aY++){var bb=bc.rows.item(aY),aZ=gy(bb.metadata);aQ=bb.maxSeq;var bf=hT(bb.winningDoc,aZ.id,bb.winningRev),aW=aK.processChange(bf,aZ,aK);aW.seq=bb.maxSeq;var aX=aT(aW);if("object"==typeof aX){return aK.complete(aX)}if(aX&&(aG++,aD&&aE.push(aW),aK.attachments&&aK.include_docs?iL(bf,aK,ab,bd,aV(aW)):aV(aW)()),aG===aI){break}}})},gr(aK.complete),function(){aK.continuous||aK.complete(null,{results:aE,last_seq:aQ})})}if(aK=g9(aK),aK.continuous){var aH=ab._name+":"+fu();return gS.addListener(ab._name,aH,ab,aK),gS.notify(ab._name),{cancel:function(){gS.removeListener(ab._name,aH)}}}var aF=aK.descending;aK.since=aK.since&&!aF?aK.since:0;var aI="limit" in aK?aK.limit:-1;0===aI&&(aI=1);var aD;aD="return_docs" in aK?aK.return_docs:"returnDocs" in aK?aK.returnDocs:!0;var aE=[],aG=0;aJ()},ab._close=function(aD){aD()},ab._getAttachment=function(aJ,aI,aL,aE,aD){var aK,aG=aE.ctx,aM=aL.digest,aF=aL.content_type,aH="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+iw+" WHERE digest=?";aG.executeSql(aH,[aM],function(aP,aQ){var aO=aQ.rows.item(0),aN=aO.escaped?gn(aO.body):hX(aO.body,ay);aK=aE.binary?fh(aN,aF):h3(aN),aD(null,aK)})},ab._getRevisionTree=function(aD,aE){af.readTransaction(function(aF){var aG="SELECT json AS metadata FROM "+hm+" WHERE id = ?";aF.executeSql(aG,[aD],function(aH,aJ){if(aJ.rows.length){var aI=gy(aJ.rows.item(0).metadata);aE(null,aI.rev_tree)}else{aE(ii(h5))}})})},ab._doCompaction=function(aE,aF,aD){return aF.length?void af.transaction(function(aH){var aG="SELECT json AS metadata FROM "+hm+" WHERE id = ?";aH.executeSql(aG,[aE],function(aI,aK){var aJ=gy(aK.rows.item(0).metadata);a3(aJ.rev_tree,function(aQ,aO,aR,aP,aM){var aN=aO+"-"+aR;-1!==aF.indexOf(aN)&&(aM.status="missing")});var aL="UPDATE "+hm+" SET json = ? WHERE id = ?";aI.executeSql(aL,[Y(aJ),aE])}),jv(aF,aE,aH)},gr(aD),function(){aD()}):aD()},ab._getLocal=function(aD,aE){af.readTransaction(function(aF){var aG="SELECT json, rev FROM "+gq+" WHERE id=?";aF.executeSql(aG,[aD],function(aH,aJ){if(aJ.rows.length){var aI=aJ.rows.item(0),aK=hT(aI.json,aD,aI.rev);aE(null,aK)}else{aE(ii(h5))}})})},ab._putLocal=function(aI,aE,aK){function aD(aO){var aM,aN;aJ?(aM="UPDATE "+gq+" SET rev=?, json=? WHERE id=? AND rev=?",aN=[aL,aF,aG,aJ]):(aM="INSERT INTO "+gq+" (id, rev, json) VALUES (?,?,?)",aN=[aG,aL,aF]),aO.executeSql(aM,aN,function(aP,aQ){aQ.rowsAffected?(aH={ok:!0,id:aG,rev:aL},aE.ctx&&aK(null,aH)):aK(ii(g3))},function(){return aK(ii(g3)),!1})}"function"==typeof aE&&(aK=aE,aE={}),delete aI._revisions;var aL,aJ=aI._rev,aG=aI._id;aL=aJ?aI._rev="0-"+(parseInt(aJ.split("-")[1],10)+1):aI._rev="0-1";var aH,aF=jx(aI);aE.ctx?aD(aE.ctx):af.transaction(aD,gr(aK),function(){aH&&aK(null,aH)})},ab._removeLocal=function(aE,aG,aH){function aF(aI){var aJ="DELETE FROM "+gq+" WHERE id=? AND rev=?",aK=[aE._id,aE._rev];aI.executeSql(aJ,aK,function(aL,aM){return aM.rowsAffected?(aD={ok:!0,id:aE._id,rev:"0-0"},void (aG.ctx&&aH(null,aD))):aH(ii(h5))})}"function"==typeof aG&&(aH=aG,aG={});var aD;aG.ctx?aF(aG.ctx):af.transaction(aF,gr(aH),function(){aD&&aH(null,aD)})},ab._destroy=function(aD,aE){gS.removeAllListeners(ab._name),af.transaction(function(aF){var aG=[hm,il,iw,T,gq,i0];aG.forEach(function(aH){aF.executeSql("DROP TABLE IF EXISTS "+aH,[])})},gr(aE),function(){ga()&&(delete window.localStorage["_pouch__websqldb_"+ab._name],delete window.localStorage[ab._name]),aE(null,{ok:!0})})}}function v(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(t){return !1}}function hd(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var t=ga(),aa="_pouch__websqldb_valid_"+navigator.userAgent;if(t&&localStorage[aa]){return"1"===localStorage[aa]}var ab=v();return t&&(localStorage[aa]=ab?"1":"0"),ab}function h1(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:hd()}function L(t){return function(ad,aa,ac,ab){if("undefined"!=typeof sqlitePlugin){var af=hI.extend({},t,{name:ad,version:aa,description:ac,size:ab});return sqlitePlugin.openDatabase(af)}return openDatabase(ad,aa,ac,ab)}}function r(aa,ac){var t=L(aa),ab=hI.extend({websql:t},aa);hr.call(this,ab,ac)}function gF(t){t.adapter("websql",r,!0)}function iN(){for(var aa={},ac=new gi(function(af,ad){aa.resolve=af,aa.reject=ad}),t=new Array(arguments.length),ab=0;ab<t.length;ab++){t[ab]=arguments[ab]}return aa.promise=ac,gi.resolve().then(function(){return fetch.apply(null,t)}).then(function(ad){aa.resolve(ad)})["catch"](function(ad){aa.reject(ad)}),aa}function j(ad,aa){var ag,t,ac,ab=new Headers,af={method:ad.method,credentials:"include",headers:ab};return ad.json&&(ab.set("Accept","application/json"),ab.set("Content-Type",ad.headers["Content-Type"]||"application/json")),ad.body&&ad.body instanceof Blob?a7(ad.body,function(ah){af.body=ah}):ad.body&&ad.processData&&"string"!=typeof ad.body?af.body=JSON.stringify(ad.body):"body" in ad?af.body=ad.body:af.body=null,Object.keys(ad.headers).forEach(function(ah){ad.headers.hasOwnProperty(ah)&&ab.set(ah,ad.headers[ah])}),ag=iN(ad.url,af),ad.timeout>0&&(t=setTimeout(function(){ag.reject(new Error("Load timeout for resource: "+ad.url))},ad.timeout)),ag.promise.then(function(ah){return ac={statusCode:ah.status},ad.timeout>0&&clearTimeout(t),ac.statusCode>=200&&ac.statusCode<300?ad.binary?ah.blob():ah.text():ah.json()}).then(function(ah){ac.statusCode>=200&&ac.statusCode<300?aa(null,ac,ah):aa(ah,ac)})["catch"](function(ah){aa(ah,ac)}),{abort:ag.reject}}function fq(aj,ag){var ac,af,ab=!1,aa=function(){ac.abort()},ah=function(){ab=!0,ac.abort()};ac=aj.xhr?new aj.xhr:new XMLHttpRequest;try{ac.open(aj.method,aj.url)}catch(ad){ag(ad,{statusCode:413})}ac.withCredentials="withCredentials" in aj?aj.withCredentials:!0,"GET"===aj.method?delete aj.headers["Content-Type"]:aj.json&&(aj.headers.Accept="application/json",aj.headers["Content-Type"]=aj.headers["Content-Type"]||"application/json",aj.body&&aj.processData&&"string"!=typeof aj.body&&(aj.body=JSON.stringify(aj.body))),aj.binary&&(ac.responseType="arraybuffer"),"body" in aj||(aj.body=null);for(var t in aj.headers){aj.headers.hasOwnProperty(t)&&ac.setRequestHeader(t,aj.headers[t])}return aj.timeout>0&&(af=setTimeout(ah,aj.timeout),ac.onprogress=function(){clearTimeout(af),4!==ac.readyState&&(af=setTimeout(ah,aj.timeout))},"undefined"!=typeof ac.upload&&(ac.upload.onprogress=ac.onprogress)),ac.onreadystatechange=function(){if(4===ac.readyState){var ak={statusCode:ac.status};if(ac.status>=200&&ac.status<300){var am;am=aj.binary?gI([ac.response||""],{type:ac.getResponseHeader("Content-Type")}):ac.responseText,ag(null,ak,am)}else{var ap={};if(ab){ap=new Error("ETIMEDOUT"),ak.statusCode=400}else{try{ap=JSON.parse(ac.response)}catch(al){}}ag(ap,ak)}}},aj.body&&aj.body instanceof Blob?a7(aj.body,function(ak){ac.send(ak)}):ac.send(aj.body),{abort:aa}}function fg(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function E(t,aa){return ic||t.xhr?fq(t,aa):j(t,aa)}function an(){return""}function iW(t,ab){function ac(ag,ah,af){if(!t.binary&&t.json&&"string"==typeof ag){try{ag=JSON.parse(ag)}catch(aj){return af(aj)}}Array.isArray(ag)&&(ag=ag.map(function(ak){return ak.error||ak.missing?go(ak):ak})),t.binary&&jz(ag,ah),af(null,ag,ah)}function aa(af,ah){var ak,ag;if(af.code&&af.status){var al=new Error(af.message||af.code);return al.status=af.status,ah(al)}if(af.message&&"ETIMEDOUT"===af.message){return ah(af)}try{ak=JSON.parse(af.responseText),ag=go(ak)}catch(aj){ag=go(af)}ah(ag)}t=g9(t);var ad={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return t=hI.extend(ad,t),t.json&&(t.binary||(t.headers.Accept="application/json"),t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json"),t.binary&&(t.encoding=null,t.json=!1),t.processData||(t.json=!1),E(t,function(af,aj,al){if(af){return af.status=aj?aj.statusCode:400,aa(af,ab)}var ah,ak=aj.headers&&aj.headers["content-type"],am=al||an();if(!t.binary&&(t.json||!t.processData)&&"object"!=typeof am&&(/json/.test(ak)||/^[\s]*\{/.test(am)&&/\}[\s]*$/.test(am))){try{am=JSON.parse(am.toString())}catch(ag){}}aj.statusCode>=200&&aj.statusCode<300?ac(am,aj,ab):(ah=go(am),ah.status=aj.statusCode,ab(ah))})}function g7(ah,af){var ak=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",ac=-1!==ak.indexOf("safari")&&-1===ak.indexOf("chrome"),aa=-1!==ak.indexOf("msie"),aj=-1!==ak.indexOf("edge"),ag=ac||(aa||aj)&&"GET"===ah.method,ad="cache" in ah?ah.cache:!0,t=/^blob:/.test(ah.url);if(!t&&(ag||!ad)){var ab=-1!==ah.url.indexOf("?");ah.url+=(ab?"&":"?")+"_nonce="+Date.now()}return iW(ah,af)}function fw(t){var aa=t.doc&&t.doc._attachments;aa&&Object.keys(aa).forEach(function(ac){var ab=aa[ac];ab.data=dt(ab.data,ab.content_type)})}function l(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function im(t){return t._attachments&&Object.keys(t._attachments)?gi.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?new gi(function(ac){i3(aa.data,ac)}).then(function(ac){aa.data=ac}):void 0})):gi.resolve()}function gV(t){var aa=h2(t);(aa.user||aa.password)&&(aa.auth={username:aa.user,password:aa.password});var ab=aa.path.replace(/(^\/|\/$)/g,"").split("/");return aa.db=ab.pop(),-1===aa.db.indexOf("%")&&(aa.db=encodeURIComponent(aa.db)),aa.path=ab.join("/"),aa}function ha(t,aa){return ar(t,t.db+"/"+aa)}function ar(t,aa){var ab=t.path?"/":"";return t.protocol+"://"+t.host+(t.port?":"+t.port:"")+"/"+t.path+ab+aa}function i6(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function fT(aj,ac){function ap(ax,aA,az){var ay=ax.ajax||{},aw=hI.extend(g9(aa),ay,aA);return jj(aw.method+" "+aw.url),ah._ajax(aw,az)}function ab(aw,ax){return new gi(function(az,ay){ap(aw,ax,function(aA,aB){return aA?ay(aA):void az(aB)})})}function al(aw,ax){return co(aw,hg(function(ay){aq().then(function(){return ax.apply(this,ay)})["catch"](function(az){var aA=ay.pop();aA(az)})}))}function aq(){if(aj.skipSetup||aj.skip_setup){return gi.resolve()}if(ak){return ak}var aw={method:"GET",url:au};return ak=ab({},aw)["catch"](function(ax){return ax&&ax.status&&404===ax.status?(iu(404,"PouchDB is just detecting if the remote exists."),ab({},{method:"PUT",url:au})):gi.reject(ax)})["catch"](function(ax){return ax&&ax.status&&412===ax.status?!0:gi.reject(ax)}),ak["catch"](function(){ak=null}),ak}function am(aw){return aw.split("/").map(encodeURIComponent).join("/")}var ah=this,av=gV;aj.getHost&&(av=aj.getHost);var af=av(aj.name,aj),au=ha(af,"");aj=g9(aj);var aa=aj.ajax||{};if(ah.getUrl=function(){return au},ah.getHeaders=function(){return aa.headers||{}},aj.auth||af.auth){var t=aj.auth||af.auth,ad=t.username+":"+t.password,ag=h3(unescape(encodeURIComponent(ad)));aa.headers=aa.headers||{},aa.headers.Authorization="Basic "+ag}ah._ajax=g7;var ak;setTimeout(function(){ac(null,ah)}),ah.type=function(){return"http"},ah.id=al("id",function(aw){ap({},{method:"GET",url:ar(af,"")},function(az,ax){var ay=ax&&ax.uuid?ax.uuid+af.db:ha(af,"");aw(null,ay)})}),ah.request=al("request",function(aw,ax){aw.url=ha(af,aw.url),ap({},aw,ax)}),ah.compact=al("compact",function(aw,ax){"function"==typeof aw&&(ax=aw,aw={}),aw=g9(aw),ap(aw,{url:ha(af,"_compact"),method:"POST"},function(){function ay(){ah.info(function(az,aA){aA&&!aA.compact_running?ax(null,{ok:!0}):setTimeout(ay,aw.interval||200)})}ay()})}),ah.bulkGet=co("bulkGet",function(aC,aA){function ax(aD){var aE={};aC.revs&&(aE.revs=!0),aC.attachments&&(aE.attachments=!0),ap({},{url:ha(af,"_bulk_get"+i6(aE)),method:"POST",body:{docs:aC.docs}},aD)}function aB(){function aH(aK){return function(aM,aL){aE[aK]=aL.results,++aG===aJ&&aA(null,{results:a9(aE)})}}for(var aD=h9,aJ=Math.ceil(aC.docs.length/aD),aG=0,aE=new Array(aJ),aF=0;aJ>aF;aF++){var aI=fc(aC,["revs","attachments"]);aI.ajax=aa,aI.docs=aC.docs.slice(aF*aD,Math.min(aC.docs.length,(aF+1)*aD)),gf(az,aI,aH(aF))}}var az=this,ay=ar(af,""),aw=C[ay];"boolean"!=typeof aw?ax(function(aF,aE){if(aF){var aD=Math.floor(aF.status/100);4===aD||5===aD?(C[ay]=!1,iu(aF.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),aB()):aA(aF)}else{C[ay]=!0,aA(null,aE)}}):aw?ax(aA):aB()}),ah._info=function(aw){aq().then(function(){ap({},{method:"GET",url:ha(af,"")},function(ay,ax){return ay?aw(ay):(ax.host=ha(af,""),void aw(null,ax))})})["catch"](aw)},ah.get=al("get",function(aA,aC,ax){function aB(aE){var aD=aE._attachments,aF=aD&&Object.keys(aD);return aD&&aF.length?gi.all(aF.map(function(aH){var aG=aD[aH],aI=l(aE._id)+"/"+am(aH)+"?rev="+aE._rev;return ab(aC,{method:"GET",url:ha(af,aI),binary:!0}).then(function(aJ){return aC.binary?aJ:new gi(function(aK){i3(aJ,aK)})}).then(function(aJ){delete aG.stub,delete aG.length,aG.data=aJ})})):void 0}function az(aD){return Array.isArray(aD)?gi.all(aD.map(function(aE){return aE.ok?aB(aE.ok):void 0})):aB(aD)}"function"==typeof aC&&(ax=aC,aC={}),aC=g9(aC);var aw={};aC.revs&&(aw.revs=!0),aC.revs_info&&(aw.revs_info=!0),aC.open_revs&&("all"!==aC.open_revs&&(aC.open_revs=JSON.stringify(aC.open_revs)),aw.open_revs=aC.open_revs),aC.rev&&(aw.rev=aC.rev),aC.conflicts&&(aw.conflicts=aC.conflicts),aA=l(aA);var ay={method:"GET",url:ha(af,aA+i6(aw))};ab(aC,ay).then(function(aD){return gi.resolve().then(function(){return aC.attachments?az(aD):void 0}).then(function(){ax(null,aD)})})["catch"](ax)}),ah.remove=al("remove",function(aB,az,ax,ay){var aA;"string"==typeof az?(aA={_id:aB,_rev:az},"function"==typeof ax&&(ay=ax,ax={})):(aA=aB,"function"==typeof az?(ay=az,ax={}):(ay=ax,ax=az));var aw=aA._rev||ax.rev;ap(ax,{method:"DELETE",url:ha(af,l(aA._id))+"?rev="+aw},ay)}),ah.getAttachment=al("getAttachment",function(aB,ax,az,aA){"function"==typeof az&&(aA=az,az={});var aw=az.rev?"?rev="+az.rev:"",ay=ha(af,l(aB))+"/"+am(ax)+aw;ap(az,{method:"GET",url:ay,binary:!0},aA)}),ah.removeAttachment=al("removeAttachment",function(ax,aA,ay,az){var aw=ha(af,l(ax)+"/"+am(aA))+"?rev="+ay;ap({},{method:"DELETE",url:aw},az)}),ah.putAttachment=al("putAttachment",function(aB,ax,aG,aF,aD,aw){"function"==typeof aD&&(aw=aD,aD=aF,aF=aG,aG=null);var ay=l(aB)+"/"+am(ax),az=ha(af,ay);if(aG&&(az+="?rev="+aG),"string"==typeof aF){var aE;try{aE=fo(aF)}catch(aA){return aw(ii(ik,"Attachment is not a valid base64 string"))}aF=aE?fh(aE,aD):""}var aC={headers:{"Content-Type":aD},method:"PUT",url:az,processData:!1,body:aF,timeout:aa.timeout||60000};ap({},aC,aw)}),ah._bulkDocs=function(ax,aw,ay){ax.new_edits=aw.new_edits,aq().then(function(){return gi.all(ax.docs.map(im))}).then(function(){ap(aw,{method:"POST",url:ha(af,"_bulk_docs"),body:ax},function(aA,az){return aA?ay(aA):(az.forEach(function(aB){aB.ok=!0}),void ay(null,az))})})["catch"](ay)},ah.allDocs=al("allDocs",function(aA,aC){"function"==typeof aA&&(aC=aA,aA={}),aA=g9(aA);var ax,aB={},az="GET";aA.conflicts&&(aB.conflicts=!0),aA.descending&&(aB.descending=!0),aA.include_docs&&(aB.include_docs=!0),aA.attachments&&(aB.attachments=!0),aA.key&&(aB.key=JSON.stringify(aA.key)),aA.start_key&&(aA.startkey=aA.start_key),aA.startkey&&(aB.startkey=JSON.stringify(aA.startkey)),aA.end_key&&(aA.endkey=aA.end_key),aA.endkey&&(aB.endkey=JSON.stringify(aA.endkey)),"undefined"!=typeof aA.inclusive_end&&(aB.inclusive_end=!!aA.inclusive_end),"undefined"!=typeof aA.limit&&(aB.limit=aA.limit),"undefined"!=typeof aA.skip&&(aB.skip=aA.skip);var ay=i6(aB);if("undefined"!=typeof aA.keys){var aw="keys="+encodeURIComponent(JSON.stringify(aA.keys));aw.length+ay.length+1<=U?ay+="&"+aw:(az="POST",ax={keys:aA.keys})}ab(aA,{method:az,url:ha(af,"_all_docs"+ay),body:ax}).then(function(aD){aA.include_docs&&aA.attachments&&aA.binary&&aD.rows.forEach(fw),aC(null,aD)})["catch"](aC)}),ah._changes=function(ay){var aF="batch_size" in ay?ay.batch_size:ir;ay=g9(ay),ay.timeout="timeout" in ay?ay.timeout:"timeout" in aa?aa.timeout:30000;var aH,az=ay.timeout?{timeout:ay.timeout-5000}:{},aw="undefined"!=typeof ay.limit?ay.limit:!1;aH="return_docs" in ay?ay.return_docs:"returnDocs" in ay?ay.returnDocs:!0;var aB=aw;if(ay.style&&(az.style=ay.style),(ay.include_docs||ay.filter&&"function"==typeof ay.filter)&&(az.include_docs=!0),ay.attachments&&(az.attachments=!0),ay.continuous&&(az.feed="longpoll"),ay.conflicts&&(az.conflicts=!0),ay.descending&&(az.descending=!0),"heartbeat" in ay?ay.heartbeat&&(az.heartbeat=ay.heartbeat):az.heartbeat=10000,ay.filter&&"string"==typeof ay.filter&&(az.filter=ay.filter),ay.view&&"string"==typeof ay.view&&(az.filter="_view",az.view=ay.view),ay.query_params&&"object"==typeof ay.query_params){for(var aJ in ay.query_params){ay.query_params.hasOwnProperty(aJ)&&(az[aJ]=ay.query_params[aJ])}}var aD,aA="GET";if(ay.doc_ids){az.filter="_doc_ids";var aC=JSON.stringify(ay.doc_ids);aC.length<U?az.doc_ids=aC:(aA="POST",aD={doc_ids:ay.doc_ids})}var aE,aG,aI=function(aM,aN){if(!ay.aborted){az.since=aM,"object"==typeof az.since&&(az.since=JSON.stringify(az.since)),ay.descending?aw&&(az.limit=aB):az.limit=!aw||aB>aF?aF:aB;var aL={method:aA,url:ha(af,"_changes"+i6(az)),timeout:ay.timeout,body:aD};aG=aM,ay.aborted||aq().then(function(){aE=ap(ay,aL,aN)})["catch"](aN)}},aK={results:[]},ax=function(aN,aL){if(!ay.aborted){var aM=0;if(aL&&aL.results){aM=aL.results.length,aK.last_seq=aL.last_seq;var aP={};aP.query=ay.query_params,aL.results=aL.results.filter(function(aR){aB--;var aQ=jB(ay)(aR);return aQ&&(ay.include_docs&&ay.attachments&&ay.binary&&fw(aR),aH&&aK.results.push(aR),ay.onChange(aR)),aQ})}else{if(aN){return ay.aborted=!0,void ay.complete(aN)}}aL&&aL.last_seq&&(aG=aL.last_seq);var aO=aw&&0>=aB||aL&&aF>aM||ay.descending;(!ay.continuous||aw&&0>=aB)&&aO?ay.complete(null,aK):setTimeout(function(){aI(aG,ax)},0)}};return aI(ay.since||0,ax),{cancel:function(){ay.aborted=!0,aE&&aE.abort()}}},ah.revsDiff=al("revsDiff",function(ax,aw,ay){"function"==typeof aw&&(ay=aw,aw={}),ap(aw,{method:"POST",url:ha(af,"_revs_diff"),body:ax},ay)}),ah._close=function(aw){aw()},ah._destroy=function(aw,ax){ap(aw,{url:ha(af,""),method:"DELETE"},function(az,ay){return az&&az.status&&404!==az.status?ax(az):void ax(null,ay)})}}function P(t){t.adapter("http",fT,!1),t.adapter("https",fT,!1)}function ip(){this.promise=new gi(function(t){t()})}function hZ(ag){var af=ag.db,t=ag.viewName,ad=ag.map,ab=ag.reduce,aa=ag.temporary,ac=ad.toString()+(ab&&ab.toString())+"undefined";if(!aa&&af._cachedViews){var ah=af._cachedViews[ac];if(ah){return gi.resolve(ah)}}return af.info().then(function(ak){function al(am){am.views=am.views||{};var aq=t;-1===aq.indexOf("/")&&(aq=t+"/"+t);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(aa?"temp":O(ac));return R(af,"_local/mrviews",al).then(function(){return af.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:af,adapter:af.adapter,mapFun:ad,reduceFun:ab};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,aa||(af._cachedViews=af._cachedViews||{},af._cachedViews[ac]=aq,aq.db.once("destroyed",function(){delete af._cachedViews[ac]})),aq})})})})}function ey(t,ab,ac,aa,ad,af){return jC("return ("+t.replace(/;\s*$/,"")+");",{emit:ab,sum:ac,log:aa,isArray:ad,toJSON:af})}function a0(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function fe(t){return 1===t.length&&/^1-/.test(t[0].rev)}function gY(t,aa){try{t.emit("error",aa)}catch(ab){iO("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),iO("error",aa)}}function ae(aa,ac,t){try{return{output:ac.apply(null,t)}}catch(ab){return gY(aa,ab),{error:ab}}}function h(t,aa){var ab=he.collate(t.key,aa.key);return 0!==ab?ab:he.collate(t.value,aa.value)}function iE(t,aa,ab){return ab=ab||0,"number"==typeof aa?t.slice(ab,aa+ab):ab>0?t.slice(ab):t}function n(t){var aa=t.value,ab=aa&&"object"==typeof aa&&aa._id||t.id;return ab}function gJ(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=dt(ac.data,ac.content_type)})})}function W(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&gJ(aa),aa}}function M(t){var aa="builtin "+t+" function requires map values to be numbers or number arrays";return new Q(aa)}function ao(ag){for(var af=0,t=0,ad=ag.length;ad>t;t++){var ab=ag[t];if("number"!=typeof ab){if(!Array.isArray(ab)){throw M("_sum")}af="number"==typeof af?[af]:af;for(var aa=0,ac=ab.length;ac>aa;aa++){var ah=ab[aa];if("number"!=typeof ah){throw M("_sum")}"undefined"==typeof af[aa]?af.push(ah):af[aa]+=ah}}else{"number"==typeof af?af+=ab:af[0]+=ab}}return af}function F(t,ab,ac,aa){var ad=ab[t];"undefined"!=typeof ad&&(aa&&(ad=encodeURIComponent(JSON.stringify(ad))),ac.push(t+"="+ad))}function k(t){if("undefined"!=typeof t){var aa=Number(t);return isNaN(aa)||aa!==parseInt(t,10)?t:aa}}function es(t){return t.group_level=k(t.group_level),t.limit=k(t.limit),t.skip=k(t.skip),t}function g8(t){if(t){if("number"!=typeof t){return new a1('Invalid value for integer: "'+t+'"')}if(0>t){return new a1('Invalid value for positive integer: "'+t+'"')}}}function br(aa,ac){var t=aa.descending?"endkey":"startkey",ab=aa.descending?"startkey":"endkey";if("undefined"!=typeof aa[t]&&"undefined"!=typeof aa[ab]&&he.collate(aa[t],aa[ab])>0){throw new a1("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(ac.reduce&&aa.reduce!==!1){if(aa.include_docs){throw new a1("{include_docs:true} is invalid for reduce")}if(aa.keys&&aa.keys.length>1&&!aa.group&&!aa.group_level){throw new a1("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=g8(aa[af]);if(ad){throw ad}})}function s(aj,ag,ac){var af,ab=[],aa="GET";if(F("reduce",ac,ab),F("include_docs",ac,ab),F("attachments",ac,ab),F("limit",ac,ab),F("descending",ac,ab),F("group",ac,ab),F("group_level",ac,ab),F("skip",ac,ab),F("stale",ac,ab),F("conflicts",ac,ab),F("startkey",ac,ab,!0),F("start_key",ac,ab,!0),F("endkey",ac,ab,!0),F("end_key",ac,ab,!0),F("inclusive_end",ac,ab),F("key",ac,ab,!0),ab=ab.join("&"),ab=""===ab?"":"?"+ab,"undefined"!=typeof ac.keys){var ah=2000,ad="keys="+encodeURIComponent(JSON.stringify(ac.keys));ad.length+ab.length+1<=ah?ab+=("?"===ab[0]?"&":"?")+ad:(aa="POST","string"==typeof ag?af={keys:ac.keys}:ag.keys=ac.keys)}if("string"==typeof ag){var t=a0(ag);return aj.request({method:aa,url:"_design/"+t[0]+"/_view/"+t[1]+ab,body:af}).then(W(ac))}return af=af||{},Object.keys(ag).forEach(function(ak){Array.isArray(ag[ak])?af[ak]=ag[ak]:af[ak]=ag[ak].toString()}),aj.request({method:"POST",url:"_temp_view"+ab,body:af}).then(W(ac))}function i(t,aa,ab){return new gi(function(ad,ac){t._query(aa,ab,function(af,ag){return af?ac(af):void ad(ag)})})}function iZ(t){return new gi(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function fr(t){return function(aa){if(404===aa.status){return t}throw aa}}function fb(ag,aa,ah){function ak(){return fe(t)?gi.resolve(ac):aa.db.get(af)["catch"](fr(ac))}function al(am){return am.keys.length?aa.db.allDocs({keys:am.keys,include_docs:!0}):gi.resolve({rows:[]})}function aj(ay,aw){for(var ap=[],av={},aq=0,am=aw.rows.length;am>aq;aq++){var az=aw.rows[aq],au=az.doc;if(au&&(ap.push(au),av[au._id]=!0,au._deleted=!ab[au._id],!au._deleted)){var ax=ab[au._id];"value" in ax&&(au.value=ax.value)}}var aA=Object.keys(ab);return aA.forEach(function(aD){if(!av[aD]){var aB={_id:aD},aC=ab[aD];"value" in aC&&(aB.value=aC.value),ap.push(aB)}}),ay.keys=jr(aA.concat(ay.keys)),ap.push(ay),ap}var af="_local/doc_"+ag,ac={_id:af,keys:[]},ad=ah[ag],ab=ad.indexableKeysToKeyValues,t=ad.changes;return ak().then(function(am){return al(am).then(function(ap){return aj(am,ap)})})}function fY(aa,ac,t){var ab="_local/lastSeq";return aa.db.get(ab)["catch"](fr({_id:ab,seq:0})).then(function(af){var ad=Object.keys(ac);return gi.all(ad.map(function(ag){return fb(ag,aa,ac)})).then(function(ag){var ah=a9(ag);return af.seq=t,ah.push(af),aa.db.bulkDocs({docs:ah})})})}function A(t){var aa="string"==typeof t?t:t.name,ab=hh[aa];return ab||(ab=hh[aa]=new ip),ab}function x(t){return hu(A(t),function(){return gG(t)})()}function gG(aj){function ag(am,ak){var al={id:ab._id,key:he.normalizeKey(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=he.normalizeKey(ak)),af.push(al)}function ac(ak,al){return function(){return fY(aj,ak,al)}}var af,ab,aa;if("function"==typeof aj.mapFun&&2===aj.mapFun.length){var ah=aj.mapFun;aa=function(ak){return ah(ak,ag)}}else{aa=ey(aj.mapFun.toString(),ag,ao,hP,Array.isArray,JSON.parse)}var ad=aj.seq||0,t=new ip;return new gi(function(ap,ak){function al(){t.finish().then(function(){aj.seq=ad,ap()})}function am(){function aq(au){ak(au)}aj.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:ad,limit:iK}).on("complete",function(ax){var aD=ax.results;if(!aD.length){return al()}for(var au={},aF=0,av=aD.length;av>aF;aF++){var aA=aD[aF];if("_"!==aA.doc._id[0]){af=[],ab=aA.doc,ab._deleted||ae(aj.sourceDB,aa,[ab]),af.sort(h);for(var ay,aC={},aB=0,aw=af.length;aw>aB;aB++){var aG=af[aB],aE=[aG.key,aG.id];0===he.collate(aG.key,ay)&&aE.push(aB);var az=he.toIndexableString(aE);aC[az]=aG,ay=aG.key}au[aA.doc._id]={indexableKeysToKeyValues:aC,changes:aA.changes}}ad=aA.seq}return t.add(ac(au,ad)),aD.length<iK?al():am()}).on("error",aq)}am()})}function iQ(ag,aa,ah){0===ah.group_level&&delete ah.group_level;var ak,al=ah.group||ah.group_level;ak=gZ[ag.reduceFun]?gZ[ag.reduceFun]:ey(ag.reduceFun.toString(),null,ao,hP,Array.isArray,JSON.parse);var aj=[],af=isNaN(ah.group_level)?Number.POSITIVE_INFINITY:ah.group_level;aa.forEach(function(aq){var am=aj[aj.length-1],ap=al?aq.key:null;return al&&Array.isArray(ap)&&(ap=ap.slice(0,af)),am&&0===he.collate(am.groupKey,ap)?(am.keys.push([aq.key,aq.id]),void am.values.push(aq.value)):void aj.push({keys:[[aq.key,aq.id]],values:[aq.value],groupKey:ap})}),aa=[];for(var ac=0,ad=aj.length;ad>ac;ac++){var ab=aj[ac],t=ae(ag.sourceDB,ak,[ab.keys,ab.values,!1]);if(t.error&&t.error instanceof Q){throw t.error}aa.push({value:t.error?null:t.output,key:ab.groupKey})}return{rows:iE(aa,ah.limit,ah.skip)}}function fz(t,aa){return hu(A(t),function(){return ho(t,aa)})()}function ho(t,ap){function ak(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return al=au.total_rows,au.rows.map(function(av){if("value" in av.doc&&"object"==typeof av.doc.value&&null!==av.doc.value){var ax=Object.keys(av.doc.value).sort(),ay=["id","key","value"];if(!(ay>ax||ax>ay)){return av.doc.value}}var aw=he.parseIndexableString(av.doc._id);return{key:aw[0],id:aw[1],value:"value" in av.doc?av.doc.value:null}})})}function am(au){var av;if(av=ah?iQ(t,au,ap):{total_rows:al,offset:ab,rows:au},ap.include_docs){var aq=jr(au.map(n));return t.sourceDB.allDocs({keys:aq,include_docs:!0,conflicts:ap.conflicts,attachments:ap.attachments,binary:ap.binary}).then(function(aw){var ax={};return aw.rows.forEach(function(ay){ay.doc&&(ax["$"+ay.id]=ay.doc)}),au.forEach(function(ay){var aA=n(ay),az=ax["$"+aA];az&&(ay.doc=az)}),av})}return av}var al,ah=t.reduceFun&&ap.reduce!==!1,ab=ap.skip||0;if("undefined"==typeof ap.keys||ap.keys.length||(ap.limit=0,delete ap.keys),"undefined"!=typeof ap.keys){var ag=ap.keys,aa=ag.map(function(aq){var au={startkey:he.toIndexableString([aq]),endkey:he.toIndexableString([aq,{}])};return ak(au)});return gi.all(aa).then(a9).then(am)}var ac={descending:ap.descending};if(ap.start_key&&(ap.startkey=ap.start_key),ap.end_key&&(ap.endkey=ap.end_key),"undefined"!=typeof ap.startkey&&(ac.startkey=ap.descending?he.toIndexableString([ap.startkey,{}]):he.toIndexableString([ap.startkey])),"undefined"!=typeof ap.endkey){var af=ap.inclusive_end!==!1;ap.descending&&(af=!af),ac.endkey=he.toIndexableString(af?[ap.endkey,{}]:[ap.endkey])}if("undefined"!=typeof ap.key){var aj=he.toIndexableString([ap.key]),ad=he.toIndexableString([ap.key,{}]);ac.descending?(ac.endkey=aj,ac.startkey=ad):(ac.startkey=aj,ac.endkey=ad)}return ah||("number"==typeof ap.limit&&(ac.limit=ap.limit),ac.skip=ab),ak(ac).then(am)}function G(t){return t.request({method:"POST",url:"_view_cleanup"})}function iA(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(ad){var ag=a0(ad),af="_design/"+ag[0],ah=ag[1];aa[af]=aa[af]||{},aa[af][ah]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(ad){var ah={};ad.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){ah[au]=ah[au]||am})})});var af=Object.keys(ah).filter(function(aj){return !ah[aj]}),ag=af.map(function(aj){return hu(A(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return gi.all(ag).then(function(){return{ok:!0}})})},fr({ok:!0}))}function m(ab,ah,ag){if("http"===ab.type()){return s(ab,ah,ag)}if("function"==typeof ab._query){return i(ab,ah,ag)}if("string"!=typeof ah){br(ag,ah);var t={db:ab,viewName:"temp_view/temp_view",map:ah.map,reduce:ah.reduce,temporary:!0};return K.add(function(){return hZ(t).then(function(ak){function aj(){return ak.db.destroy()}return iG(x(ak).then(function(){return fz(ak,ag)}),aj)})}),K.finish()}var af=ah,ac=a0(af),ad=ac[0],aa=ac[1];return ab.get("_design/"+ad).then(function(al){var ak=al.views&&al.views[aa];if(!ak||"string"!=typeof ak.map){throw new gR("ddoc "+ad+" has no view named "+aa)}br(ag,ak);var aj={db:ab,viewName:af,map:ak.map,reduce:ak.reduce};return hZ(aj).then(function(am){return"ok"===ag.stale||"update_after"===ag.stale?("update_after"===ag.stale&&iC.nextTick(function(){x(am)}),fz(am,ag)):x(am).then(function(){return fz(am,ag)})})})}function a1(t){this.status=400,this.name="query_parse_error",this.message=t,this.error=!0;try{Error.captureStackTrace(this,a1)}catch(aa){}}function gR(t){this.status=404,this.name="not_found",this.message=t,this.error=!0;try{Error.captureStackTrace(this,gR)}catch(aa){}}function Q(t){this.status=500,this.name="invalid_value",this.message=t,this.error=!0;try{Error.captureStackTrace(this,Q)}catch(aa){}}function gm(t){return/^1-/.test(t)}function X(t,aa,ab){return !t._attachments||!t._attachments[ab]||t._attachments[ab].digest!==aa._attachments[ab].digest}function fj(t,aa){var ab=Object.keys(aa._attachments);return gi.all(ab.map(function(ac){return t.getAttachment(aa._id,ac,{rev:aa._rev})}))}function ai(t,ab,ac){var aa="http"===ab.type()&&"http"!==t.type(),ad=Object.keys(ac._attachments);return aa?t.get(ac._id).then(function(af){return gi.all(ad.map(function(ag){return X(af,ac,ag)?ab.getAttachment(ac._id,ag):t.getAttachment(af._id,ag)}))})["catch"](function(af){if(404!==af.status){throw af}return fj(ab,ac)}):fj(ab,ac)}function h4(t){var aa=[];return Object.keys(t).forEach(function(ab){var ac=t[ab].missing;ac.forEach(function(ad){aa.push({id:ab,rev:ad})})}),{docs:aa,revs:!0}}function gw(ah,ac,aj,al){function ak(){var am=h4(aj);if(am.docs.length){return ah.bulkGet(am).then(function(ap){if(al.cancelled){throw new Error("cancelled")}return gi.all(ap.results.map(function(aq){return gi.all(aq.docs.map(function(au){var av=au.ok;return au.error&&(t=!1),av&&av._attachments?ai(ac,ah,av).then(function(aw){var ax=Object.keys(av._attachments);return aw.forEach(function(az,aA){var ay=av._attachments[ax[aA]];delete ay.stub,delete ay.length,ay.data=az}),av}):av}))})).then(function(aq){ab=ab.concat(a9(aq).filter(Boolean))})})}}function ag(am){return am._attachments&&Object.keys(am._attachments).length>0}function af(am){return ah.allDocs({keys:am,include_docs:!0}).then(function(ap){if(al.cancelled){throw new Error("cancelled")}ap.rows.forEach(function(aq){!aq.deleted&&aq.doc&&gm(aq.value.rev)&&!ag(aq.doc)&&(ab.push(aq.doc),delete aj[aq.id])})})}function aa(){var am=Object.keys(aj).filter(function(aq){var ap=aj[aq].missing;return 1===ap.length&&gm(ap[0])});return am.length>0?af(am):void 0}function ad(){return{ok:t,docs:ab}}aj=g9(aj);var ab=[],t=!0;return gi.resolve().then(aa).then(ak).then(ad)}function N(t,ab,ac,aa,ad){return t.get(ab)["catch"](function(af){if(404===af.status){return"http"===t.type()&&iu(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:aa,_id:ab,history:[],replicator:gU,version:en}}throw af}).then(function(af){return ad.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==aa}),af.history.unshift({last_seq:ac,session_id:aa}),af.history=af.history.slice(0,hC),af.version=en,af.replicator=gU,af.session_id=aa,af.last_seq=ac,t.put(af)["catch"](function(ag){if(409===ag.status){return N(t,ab,ac,aa,ad)}throw ag}))})}function gb(aa,ac,t,ab){this.src=aa,this.target=ac,this.id=t,this.returnValue=ab}function fs(t,aa){return t.session_id===aa.session_id?{last_seq:t.last_seq,history:t.history}:a5(t.history,aa.history)}function a5(ag,af){var t=ag[0],ad=ag.slice(1),ab=af[0],aa=af.slice(1);if(!t||0===af.length){return{last_seq:jp,history:[]}}var ac=t.session_id;if(iF(ac,af)){return{last_seq:t.last_seq,history:ag}}var ah=ab.session_id;return iF(ah,ad)?{last_seq:ab.last_seq,history:aa}:a5(ad,aa)}function iF(aa,ac){var t=ac[0],ab=ac.slice(1);return aa&&0!==ac.length?aa===t.session_id?!0:iF(aa,ab):!1}function gg(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}function cr(aa,ac,t,ab){return aa.retry===!1?(ac.emit("error",t),void ac.removeAllListeners()):("function"!=typeof aa.back_off_function&&(aa.back_off_function=fp),ac.emit("requestError",t),"active"!==ac.state&&"pending"!==ac.state||(ac.emit("paused",t),ac.state="stopped",ac.once("active",function(){aa.current_back_off=hj})),aa.current_back_off=aa.current_back_off||hj,aa.current_back_off=aa.back_off_function(aa.current_back_off),void setTimeout(ab,aa.current_back_off))}function gP(t){return Object.keys(t).sort(he.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function gD(ad,aa,ag){var t=ag.doc_ids?ag.doc_ids.sort(he.collate):"",ac=ag.filter?ag.filter.toString():"",ab="",af="";return ag.filter&&ag.query_params&&(ab=JSON.stringify(gP(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),gi.all([ad.id(),aa.id()]).then(function(aj){var ah=aj[0]+aj[1]+ac+af+ab+t;return new gi(function(ak){y(ah,ak)})}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function gc(aG,ax,af,al,ag){function aQ(){return aK?gi.resolve():gD(aG,ax,af).then(function(aS){az=aS,aK=new gb(aG,ax,az,al)})}function am(){if(aq=[],0!==aI.docs.length){var aS=aI.docs;return ax.bulkDocs({docs:aS,new_edits:!1}).then(function(aW){if(al.cancelled){throw ah(),new Error("cancelled")}var aU=[],aX={};aW.forEach(function(aY){aY.error&&(ag.doc_write_failures++,aU.push(aY),aX[aY.id]=aY)}),aH=aH.concat(aU),ag.docs_written+=aI.docs.length-aU.length;var aT=aU.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aX[aZ._id];aY?al.emit("denied",g9(aY)):aq.push(aZ)}),aT.length>0){var aV=new Error("bulkDocs error");throw aV.other_errors=aU,aP("target.bulkDocs failed to write docs",aV),new Error("bulkWrite partial failure")}},function(aT){throw ag.doc_write_failures+=aS.length,aT})}}function aw(){if(aI.error){throw new Error("There was a problem getting docs.")}ag.last_seq=aR=aI.seq;var aS=g9(ag);return aq.length&&(aS.docs=aq,al.emit("change",aS)),aN=!0,aK.writeCheckpoint(aI.seq,aF).then(function(){if(aN=!1,al.cancelled){throw ah(),new Error("cancelled")}aI=void 0,ac()})["catch"](ay)}function aD(){var aS={};return aI.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),ax.revsDiff(aS).then(function(aT){if(al.cancelled){throw ah(),new Error("cancelled")}aI.diffs=aT})}function aL(){return gw(aG,ax,aI.diffs,al).then(function(aS){aI.error=!aS.ok,aS.docs.forEach(function(aT){delete aI.diffs[aT._id],ag.docs_read++,aI.docs.push(aT)})})}function ab(){if(!al.cancelled&&!aI){if(0===aa.length){return void aB(!0)}aI=aa.shift(),aD().then(aL).then(am).then(aw).then(ab)["catch"](function(aS){aP("batch processing terminated with error",aS)})}}function aB(aS){return 0===aj.changes.length?void (0!==aa.length||aI||((au&&ad.live||ap)&&(al.state="pending",al.emit("paused")),ap&&ah())):void ((aS||ap||aj.changes.length>=aC)&&(aa.push(aj),aj={seq:0,changes:[],docs:[]},"pending"!==al.state&&"stopped"!==al.state||(al.state="active",al.emit("active")),ab()))}function aP(aS,aT){aM||(aT.message||(aT.message=aS),ag.ok=!1,ag.status="aborting",ag.errors.push(aT),aH=aH.concat(aT),aa=[],aj={seq:0,changes:[],docs:[]},ah())}function ah(){if(!(aM||al.cancelled&&(ag.status="cancelled",aN))){ag.status=ag.status||"complete",ag.end_time=new Date,ag.last_seq=aR,aM=!0;var aS=aH.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aS.length>0){var aT=aH.pop();aH.length>0&&(aT.other_errors=aH),aT.result=ag,cr(af,al,aT,function(){gc(aG,ax,af,al)})}else{ag.errors=aH,al.emit("complete",ag),al.removeAllListeners()}}}function aE(aS){if(al.cancelled){return ah()}var aT=jB(af)(aS);aT&&(aj.seq=aS.seq,aj.changes.push(aS),aB(0===aa.length&&ad.live))}function t(aS){if(av=!1,al.cancelled){return ah()}if(aS.results.length>0){ad.since=aS.last_seq,ac(),aB(!0)}else{var aT=function(){au?(ad.live=!0,ac()):ap=!0,aB(!0)};aI||0!==aS.results.length?aT():(aN=!0,aK.writeCheckpoint(aS.last_seq,aF).then(function(){aN=!1,ag.last_seq=aR=aS.last_seq,aT()})["catch"](ay))}}function ak(aS){return av=!1,al.cancelled?ah():void aP("changes rejected",aS)}function ac(){function aS(){aT.cancel()}function aU(){al.removeListener("cancel",aS)}if(!av&&!ap&&aa.length<aA){av=!0,al._changes&&(al.removeListener("cancel",al._abortChanges),al._changes.cancel()),al.once("cancel",aS);var aT=aG.changes(ad).on("change",aE);aT.then(aU,aU),aT.then(t)["catch"](ak),af.retry&&(al._changes=aT,al._abortChanges=aS)}}function aO(){aQ().then(function(){return al.cancelled?void ah():aK.getCheckpoint().then(function(aS){aR=aS,ad={since:aR,limit:aC,batch_size:aC,style:"all_docs",doc_ids:aJ,return_docs:!0},af.filter&&("string"!=typeof af.filter?ad.include_docs=!0:ad.filter=af.filter),"heartbeat" in af&&(ad.heartbeat=af.heartbeat),"timeout" in af&&(ad.timeout=af.timeout),af.query_params&&(ad.query_params=af.query_params),af.view&&(ad.view=af.view),ac()})})["catch"](function(aS){aP("getCheckpoint rejected with ",aS)})}function ay(aS){throw aN=!1,aP("writeCheckpoint completed with error",aS),aS}var aI,az,aK,aa=[],aj={seq:0,changes:[],docs:[]},aN=!1,ap=!1,aM=!1,aR=0,au=af.continuous||af.live||!1,aC=af.batch_size||100,aA=af.batches_limit||10,av=!1,aJ=af.doc_ids,aH=[],aq=[],aF=fu();ag=ag||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var ad={};return al.ready(aG,ax),al.cancelled?void ah():(al._addedListeners||(al.once("cancel",ah),"function"==typeof af.complete&&(al.once("error",af.complete),al.once("complete",function(aS){af.complete(null,aS)})),al._addedListeners=!0),void ("undefined"==typeof af.since?aO():aQ().then(function(){return aN=!0,aK.writeCheckpoint(af.since,aF)}).then(function(){return aN=!1,al.cancelled?void ah():(aR=af.since,void aO())})["catch"](ay)))}function gp(){i5.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var t=this,aa=new gi(function(ac,ab){t.once("complete",ac),t.once("error",ab)});t.then=function(ac,ab){return aa.then(ac,ab)},t["catch"]=function(ab){return aa["catch"](ab)},t["catch"](function(){})}function i7(t,aa){var ab=aa.PouchConstructor;return"string"==typeof t?new ab(t,aa):t}function ij(ad,aa,ag,t){if("function"==typeof ag&&(t=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw ii(fn,"`doc_ids` filter parameter is not a list.")}ag.complete=t,ag=g9(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var ac=new gp(ag),ab=i7(ad,ag),af=i7(aa,ag);return gc(ab,af,ag,ac),ac}function je(aa,ac,t,ab){return"function"==typeof t&&(ab=t,t={}),"undefined"==typeof t&&(t={}),t=g9(t),t.PouchConstructor=t.PouchConstructor||this,aa=i7(aa,t),ac=i7(ac,t),new g1(aa,ac,t,ab)}function g1(am,ad,ac,ak){function af(ay){aq.emit("change",{direction:"pull",change:ay})}function t(ay){aq.emit("change",{direction:"push",change:ay})}function ag(ay){aq.emit("denied",{direction:"push",doc:ay})}function ab(ay){aq.emit("denied",{direction:"pull",doc:ay})}function av(){aq.pushPaused=!0,aq.pullPaused&&aq.emit("paused")}function aj(){aq.pullPaused=!0,aq.pushPaused&&aq.emit("paused")}function ap(){aq.pushPaused=!1,aq.pullPaused&&aq.emit("active",{direction:"push"})}function aa(){aq.pullPaused=!1,aq.pushPaused&&aq.emit("active",{direction:"pull"})}function al(ay){return function(aC,az){var aE="change"===aC&&(az===af||az===t),aA="denied"===aC&&(az===ab||az===ag),aD="paused"===aC&&(az===aj||az===av),aB="active"===aC&&(az===aa||az===ap);(aE||aA||aD||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&aq.removeAllListeners(aC))}}var aq=this;this.canceled=!1;var ah=ac.push?hI.extend({},ac,ac.push):ac,aw=ac.pull?hI.extend({},ac,ac.pull):ac;this.push=ij(am,ad,ah),this.pull=ij(ad,am,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};ac.live&&(this.push.on("complete",aq.pull.cancel.bind(aq.pull)),this.pull.on("complete",aq.push.cancel.bind(aq.push))),this.on("newListener",function(ay){"change"===ay?(aq.pull.on("change",af),aq.push.on("change",t)):"denied"===ay?(aq.pull.on("denied",ab),aq.push.on("denied",ag)):"active"===ay?(aq.pull.on("active",aa),aq.push.on("active",ap)):"paused"===ay&&(aq.pull.on("paused",aj),aq.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(aq.pull.removeListener("change",af),aq.push.removeListener("change",t)):"denied"===ay?(aq.pull.removeListener("denied",ab),aq.push.removeListener("denied",ag)):"active"===ay?(aq.pull.removeListener("active",aa),aq.push.removeListener("active",ap)):"paused"===ay&&(aq.pull.removeListener("paused",aj),aq.push.removeListener("paused",av))}),this.pull.on("removeListener",al("pull")),this.push.on("removeListener",al("push"));var au=gi.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return aq.emit("complete",az),ak&&ak(null,az),aq.removeAllListeners(),az},function(ay){if(aq.cancel(),ak?ak(ay):aq.emit("error",ay),aq.removeAllListeners(),ak){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function io(t){t.replicate=ij,t.sync=je}var at,hI=e(9),jm=fy(e(5)),hc=fy(e(8)),hw=fy(e(10)),hK=e(14),hg=fy(e(4)),i5=e(1),jC=fy(e(15)),hx=fy(e(16)),i8=fy(e(17)),he=e(12),gi="function"==typeof Promise?Promise:hw,de=Function.prototype.toString,gN=de.call(Object),ju=jm("pouchdb:api"),hi=6;if(iz()){at=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),at=!!localStorage.getItem("_pouch_check_localstorage")}catch(iq){at=!1}}hc(gC,i5.EventEmitter),gC.prototype.addListener=function(ad,aa,ag,t){function ac(){function aj(){af=!1}if(ab._listeners[aa]){if(af){return void (af="waiting")}af=!0;var ah=fc(t,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ag.changes(ah).on("change",function(ak){ak.seq>t.since&&!t.cancelled&&(t.since=ak.seq,t.onChange(ak))}).on("complete",function(){"waiting"===af&&setTimeout(function(){ac()},0),af=!1}).on("error",aj)}}if(!this._listeners[aa]){var ab=this,af=!1;this._listeners[aa]=ac,this.on(ad,ac)}},gC.prototype.removeListener=function(t,aa){aa in this._listeners&&i5.EventEmitter.prototype.removeListener.call(this,t,this._listeners[aa])},gC.prototype.notifyLocalWindows=function(t){iz()?chrome.storage.local.set({dbName:t}):ga()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},gC.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)},hc(hE,Error),hE.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var hy=new hE({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),hS=new hE({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),h5=new hE({status:404,error:"not_found",reason:"missing"}),g3=new hE({status:409,error:"conflict",reason:"Document update conflict"}),hO=new hE({status:400,error:"invalid_id",reason:"_id field must contain a string"}),fV=new hE({status:412,error:"missing_id",reason:"_id is required for puts"}),et=new hE({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),h7=new hE({status:412,error:"precondition_failed",reason:"Database not open"}),ew=new hE({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),ik=new hE({status:500,error:"badarg",reason:"Some query argument is invalid"}),hl=new hE({status:400,error:"invalid_request",reason:"Request was invalid"}),gB=new hE({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),ei=new hE({status:500,error:"doc_validation",reason:"Bad special document member"}),fn=new hE({status:400,error:"bad_request",reason:"Something wrong with the request"}),gW=new hE({status:400,error:"bad_request",reason:"Document must be a JSON object"}),ht=new hE({status:404,error:"not_found",reason:"Database not found"}),gx=new hE({status:500,error:"indexed_db_went_bad",reason:"unknown"}),gL=new hE({status:500,error:"web_sql_went_bad",reason:"unknown"}),D=new hE({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),iV=new hE({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),iB=new hE({status:400,error:"bad_request",reason:"Invalid rev format"}),bt=new hE({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),i4=new hE({status:412,error:"missing_stub"}),fm=new hE({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),gt=[hy,hS,h5,g3,hO,fV,et,h7,ew,ik,hl,gB,ei,fn,gW,ht,gL,D,iV,iB,bt,i4,gx,fm],gu=function(aa,ac,t){var ab=gt.filter(function(ad){return ad[aa]===ac});return t&&ab.filter(function(ad){return ad.message===t})[0]||ab[0]},q=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],hG="queryKey",ez=/(?:^|&)([^&=]*)=?([^&]*)/g,be=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,fX="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");hc(bo,i5.EventEmitter),bo.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},bo.prototype.doChanges=function(t){var ab=this,ac=t.complete;if(t=g9(t),"live" in t&&!("continuous" in t)&&(t.continuous=t.live),t.processChange=i1,"latest"===t.since&&(t.since="now"),t.since||(t.since=0),"now"===t.since){return void this.db.info().then(function(af){return ab.isCancelled?void ac(null,{status:"cancelled"}):(t.since=af.update_seq,void ab.doChanges(t))},ac)}if(t.continuous&&"now"!==t.since&&this.db.info().then(function(af){ab.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),t.view&&!t.filter&&(t.filter="_view"),t.filter&&"string"==typeof t.filter&&("_view"===t.filter?t.view=gE(t.view):t.filter=gE(t.filter),"http"!==this.db.type()&&!t.doc_ids)){return this.filterChanges(t)}"descending" in t||(t.descending=!1),t.limit=0===t.limit?1:t.limit,t.complete=ac;var aa=this.db._changes(t);if(aa&&"function"==typeof aa.cancel){var ad=ab.cancel;ab.cancel=hg(function(af){aa.cancel(),ad.apply(this,af)})}},bo.prototype.filterChanges=function(t){var ab=this,ac=t.complete;if("_view"===t.filter){if(!t.view||"string"!=typeof t.view){var aa=ii(fn,"`view` filter parameter not found or invalid.");return ac(aa)}var ad=jd(t.view);this.db.get("_design/"+ad[0],function(aj,ag){if(ab.isCancelled){return ac(null,{status:"cancelled"})}if(aj){return ac(go(aj))}var ah=ag&&ag.views&&ag.views[ad[1]]&&ag.views[ad[1]].map;return ah?(t.filter=iP(ah),void ab.doChanges(t)):ac(ii(h5,ag.views?"missing json key: "+ad[1]:"missing json key: views"))})}else{var af=jd(t.filter);if(!af){return ab.doChanges(t)}this.db.get("_design/"+af[0],function(ah,ag){if(ab.isCancelled){return ac(null,{status:"cancelled"})}if(ah){return ac(go(ah))}var aj=ag&&ag.filters&&ag.filters[af[1]];return aj?(t.filter=iv(aj),void ab.doChanges(t)):ac(ii(h5,ag&&ag.filters?"missing json key: "+af[1]:"missing json key: filters"))})}},hc(jl,i5.EventEmitter),jl.prototype.post=co("post",function(t,aa,ab){return"function"==typeof aa&&(ab=aa,aa={}),"object"!=typeof t||Array.isArray(t)?ab(ii(gW)):void this.bulkDocs({docs:[t]},aa,gs(ab))}),jl.prototype.put=co("put",hg(function(aj){function ag(){ah||(iO("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),ah=!0)}var ac,af,ab,aa,ah=!1,ad=aj.shift(),t="_id" in ad;if("object"!=typeof ad||Array.isArray(ad)){return(aa=aj.pop())(ii(gW))}for(;;){if(ac=aj.shift(),af=typeof ac,"string"!==af||t?"string"!==af||!t||"_rev" in ad?"object"===af?ab=ac:"function"===af&&(aa=ac):(ag(),ad._rev=ac):(ag(),ad._id=ac,t=!0),!aj.length){break}}return ab=ab||{},hs(ad._id),ex(ad._id)&&"function"==typeof this._putLocal?ad._deleted?this._removeLocal(ad,aa):this._putLocal(ad,aa):void this.bulkDocs({docs:[ad]},ab,gs(aa))})),jl.prototype.putAttachment=co("putAttachment",function(ad,aa,ag,t,ac){function ab(ah){var aj="_rev" in ah?parseInt(ah._rev,10):0;return ah._attachments=ah._attachments||{},ah._attachments[aa]={content_type:ac,data:t,revpos:++aj},af.put(ah)}var af=this;return"function"==typeof ac&&(ac=t,t=ag,ag=null),"undefined"==typeof ac&&(ac=t,t=ag,ag=null),af.get(ad).then(function(ah){if(ah._rev!==ag){throw ii(g3)}return ab(ah)},function(ah){if(ah.reason===h5.message){return ab({_id:ad})}throw ah})}),jl.prototype.removeAttachment=co("removeAttachment",function(t,ab,ac,aa){var ad=this;ad.get(t,function(af,ag){return af?void aa(af):ag._rev!==ac?void aa(ii(g3)):ag._attachments?(delete ag._attachments[ab],0===Object.keys(ag._attachments).length&&delete ag._attachments,void ad.put(ag,aa)):aa()})}),jl.prototype.remove=co("remove",function(t,ab,ac,aa){var ad;"string"==typeof ab?(ad={_id:t,_rev:ab},"function"==typeof ac&&(aa=ac,ac={})):(ad=t,"function"==typeof ab?(aa=ab,ac={}):(aa=ac,ac=ab)),ac=ac||{},ac.was_delete=!0;var af={_id:ad._id,_rev:ad._rev||ac.rev};return af._deleted=!0,ex(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(ad,aa):void this.bulkDocs({docs:[af]},ac,gs(aa))}),jl.prototype.revsDiff=co("revsDiff",function(ag,af,t){function ad(ak,aj){ah.has(ak)||ah.set(ak,{missing:[]}),ah.get(ak).missing.push(aj)}function ab(aj,ak){var al=ag[aj].slice(0);a3(ak,function(aw,am,ap,av,aq){var ax=am+"-"+ap,au=al.indexOf(ax);-1!==au&&(al.splice(au,1),"available"!==aq.status&&ad(aj,ax))}),al.forEach(function(am){ad(aj,am)})}"function"==typeof af&&(t=af,af={});var aa=Object.keys(ag);if(!aa.length){return t(null,{})}var ac=0,ah=new hK.Map;aa.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){ah.set(aj,{missing:ag[aj]})}else{if(al){return t(al)}ab(aj,am)}if(++ac===aa.length){var ak={};return ah.forEach(function(ap,aq){ak[aq]=ap}),t(null,ak)}})},this)}),jl.prototype.bulkGet=co("bulkGet",function(t,aa){gf(this,t,aa)}),jl.prototype.compactDocument=co("compactDocument",function(aa,ac,t){var ab=this;this._getRevisionTree(aa,function(af,ah){if(af){return t(af)}var ad=hU(ah),ag=[],aj=[];Object.keys(ad).forEach(function(ak){ad[ak]>ac&&ag.push(ak)}),a3(ah,function(ak,am,aq,al,au){var ap=am+"-"+aq;"available"===au.status&&-1!==ag.indexOf(ap)&&aj.push(ap)}),ab._doCompaction(aa,aj,t)})}),jl.prototype.compact=co("compact",function(t,aa){"function"==typeof t&&(aa=t,t={});var ab=this;t=t||{},ab._compactionQueue=ab._compactionQueue||[],ab._compactionQueue.push({opts:t,callback:aa}),1===ab._compactionQueue.length&&ev(ab)}),jl.prototype._compact=function(ad,aa){function ag(ah){af.push(ac.compactDocument(ah.id,0))}function t(ah){var aj=ah.last_seq;gi.all(af).then(function(){return R(ac,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<aj?(ak.last_seq=aj,ak):!1})}).then(function(){aa(null,{ok:!0})})["catch"](aa)}var ac=this,ab={return_docs:!1,last_seq:ad.last_seq||0},af=[];ac.changes(ab).on("change",ag).on("complete",t).on("error",aa)},jl.prototype.get=co("get",function(ag,af,t){function ad(){var ak=[],aj=ab.length;return aj?void ab.forEach(function(al){aa.get(ag,{rev:al,revs:af.revs,attachments:af.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||t(null,ak)})}):t(null,ak)}if("function"==typeof af&&(t=af,af={}),"string"!=typeof ag){return t(ii(hO))}if(ex(ag)&&"function"==typeof this._getLocal){return this._getLocal(ag,t)}var ab=[],aa=this;if(!af.open_revs){return this._get(ag,af,function(am,al){if(am){return t(am)}var ay=al.doc,ap=al.metadata,ax=al.ctx;if(af.conflicts){var az=gk(ap);az.length&&(ay._conflicts=az)}if(jo(ap,ay._rev)&&(ay._deleted=!0),af.revs||af.revs_info){var aj=hB(ap.rev_tree),au=gK(aj,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(ay._rev.split("-")[1])}),aw=au.ids.map(function(aC){return aC.id}).indexOf(ay._rev.split("-")[1])+1,aA=au.ids.length-aw;if(au.ids.splice(aw,aA),au.ids.reverse(),af.revs&&(ay._revisions={start:au.pos+au.ids.length-1,ids:au.ids.map(function(aC){return aC.id})}),af.revs_info){var aq=au.pos+au.ids.length;ay._revs_info=au.ids.map(function(aC){return aq--,{rev:aq+"-"+aC.id,status:aC.opts.status}})}}if(af.attachments&&ay._attachments){var ak=ay._attachments,aB=Object.keys(ak).length;if(0===aB){return t(null,ay)}Object.keys(ak).forEach(function(aC){this._getAttachment(ay._id,aC,ak[aC],{rev:ay._rev,binary:af.binary,ctx:ax},function(aE,aD){var aF=ay._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--aB||t(null,ay)})},aa)}else{if(ay._attachments){for(var av in ay._attachments){ay._attachments.hasOwnProperty(av)&&(ay._attachments[av].stub=!0)}}t(null,ay)}})}if("all"===af.open_revs){this._getRevisionTree(ag,function(ak,aj){return ak?t(ak):(ab=w(aj).map(function(al){return al.rev}),void ad())})}else{if(!Array.isArray(af.open_revs)){return t(ii(ew,"function_clause"))}ab=af.open_revs;for(var ac=0;ac<ab.length;ac++){var ah=ab[ac];if("string"!=typeof ah||!/^\d+-/.test(ah)){return t(ii(iB))}}ad()}}),jl.prototype.getAttachment=co("getAttachment",function(t,ab,ac,aa){var ad=this;ac instanceof Function&&(aa=ac,ac={}),this._get(t,ac,function(af,ag){return af?aa(af):ag.doc._attachments&&ag.doc._attachments[ab]?(ac.ctx=ag.ctx,ac.binary=!0,ad._getAttachment(t,ab,ag.doc._attachments[ab],ac,aa),void 0):aa(ii(h5))})}),jl.prototype.allDocs=co("allDocs",function(t,aa){if("function"==typeof t&&(aa=t,t={}),t.skip="undefined"!=typeof t.skip?t.skip:0,t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),"keys" in t){if(!Array.isArray(t.keys)){return aa(new TypeError("options.keys must be an array"))}var ab=["startkey","endkey","key"].filter(function(ac){return ac in t})[0];if(ab){return void aa(ii(gB,"Query parameter `"+ab+"` is not compatible with multi-get"))}if("http"!==this.type()){return V(this,t,aa)}}return this._allDocs(t,aa)}),jl.prototype.changes=function(t,aa){return"function"==typeof t&&(aa=t,t={}),new bo(this,t,aa)},jl.prototype.close=co("close",function(t){return this._closed=!0,this._close(t)}),jl.prototype.info=co("info",function(t){var aa=this;this._info(function(ab,ac){return ab?t(ab):(ac.db_name=ac.db_name||aa._db_name,ac.auto_compaction=!(!aa.auto_compaction||"http"===aa.type()),ac.adapter=aa.type(),void t(null,ac))})}),jl.prototype.id=co("id",function(t){return this._id(t)}),jl.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},jl.prototype.bulkDocs=co("bulkDocs",function(t,ab,ac){if("function"==typeof ab&&(ac=ab,ab={}),ab=ab||{},Array.isArray(t)&&(t={docs:t}),!t||!t.docs||!Array.isArray(t.docs)){return ac(ii(hS))}for(var aa=0;aa<t.docs.length;++aa){if("object"!=typeof t.docs[aa]||Array.isArray(t.docs[aa])){return ac(ii(gW))}}var ad;return t.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){ad=ad||h0(ag)})}),ad?ac(ii(fn,ad)):("new_edits" in ab||("new_edits" in t?ab.new_edits=t.new_edits:ab.new_edits=!0),ab.new_edits||"http"===this.type()||t.docs.sort(ct),gA(t.docs),this._bulkDocs(t,ab,function(af,ag){return af?ac(af):(ab.new_edits||(ag=ag.filter(function(ah){return ah.error})),void ac(null,ag))}))}),jl.prototype.registerDependentDatabase=co("registerDependentDatabase",function(aa,ac){function t(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[aa]?!1:(ad.dependentDbs[aa]=!0,ad)}var ab=new this.constructor(aa,this.__opts);R(this,"_local/_pouch_dependentDbs",t).then(function(){ac(null,{db:ab})})["catch"](ac)}),jl.prototype.destroy=co("destroy",function(t,ab){function ac(){aa._destroy(t,function(ag,af){return ag?ab(ag):(aa._destroyed=!0,aa.emit("destroyed"),void ab(null,af||{ok:!0}))})}"function"==typeof t&&(ab=t,t={});var aa=this,ad="use_prefix" in aa?aa.use_prefix:!0;return"http"===aa.type()?ac():void aa.get("_local/_pouch_dependentDbs",function(af,ah){if(af){return 404!==af.status?ab(af):ac()}var ak=ah.dependentDbs,ag=aa.constructor,aj=Object.keys(ak).map(function(al){var am=ad?al.replace(new RegExp("^"+ag.prefix),""):al;return new ag(am,aa.__opts).destroy()});gi.all(aj).then(ac,ab)})}),fv.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},fv.prototype.fail=function(t){this.failed=t,this.execute()},fv.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},fv.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},hc(fx,jl),fx.debug=jm,fx.adapters={},fx.preferredAdapters=[],fx.prefix="_pouch_";var hM=new i5.EventEmitter;hA(fx),fx.parseAdapter=function(ag,af){var t,ad,ab=ag.match(/([a-z\-]*):\/\/(.*)/);if(ab){if(ag=/http(s?)/.test(ab[1])?ab[1]+"://"+ab[2]:ab[2],t=ab[1],!fx.adapters[t].valid()){throw"Invalid adapter"}return{name:ag,adapter:ab[1]}}var aa="idb" in fx.adapters&&"websql" in fx.adapters&&ga()&&localStorage["_pouch__websqldb_"+fx.prefix+ag];if(af.adapter){ad=af.adapter}else{if("undefined"!=typeof af&&af.db){ad="leveldb"}else{for(var ac=0;ac<fx.preferredAdapters.length;++ac){if(ad=fx.preferredAdapters[ac],ad in fx.adapters){if(aa&&"idb"===ad){iO("log",'PouchDB is downgrading "'+ag+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}t=fx.adapters[ad];var ah=t&&"use_prefix" in t?t.use_prefix:!0;return{name:ah?fx.prefix+ag:ag,adapter:ad}},fx.adapter=function(t,aa,ab){aa.valid()&&(fx.adapters[t]=aa,ab&&fx.preferredAdapters.push(t))},fx.plugin=function(t){return"function"==typeof t?t(fx):Object.keys(t).forEach(function(aa){fx.prototype[aa]=t[aa]}),fx},fx.defaults=function(t){function aa(ab,ad,ac){return this instanceof aa?("function"!=typeof ad&&"undefined"!=typeof ad||(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=hI.extend({},t,ad),void fx.call(this,ab,ad,ac)):new aa(ab,ad,ac)}return hc(aa,fx),aa.preferredAdapters=fx.preferredAdapters.slice(),Object.keys(fx).forEach(function(ab){ab in aa||(aa[ab]=fx[ab])}),aa};var u="5.4.4";fx.version=u;var iX,dn=fW(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),hY=fW(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),fo=function(t){return atob(t)},h3=function(t){return btoa(t)},gT=jt.setImmediate||jt.setTimeout,iU=32768,g2=5,h8="document-store",gv="by-sequence",ft="attach-store",hV="attach-seq-store",a6="meta-store",hJ="local-store",iH="detect-blob-support",iR={running:!1,queue:[]},a2=new hK.Map,B=new gC,J=new hK.Map;bn.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var ff=7,hm=jc("document-store"),il=jc("by-sequence"),iw=jc("attach-store"),gq=jc("local-store"),T=jc("metadata-store"),i0=jc("attach-seq-store"),fl=new hK.Map,gS=new gC,dr=1,ie="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+il+" (seq, deleted)",o="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+il+" (doc_id, rev)",f="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+hm+" (winningseq)",gH="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+i0+" (seq)",h6="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+i0+" (digest, seq)",p=il+".seq = "+hm+".winningseq",jb=il+".seq AS seq, "+il+".deleted AS deleted, "+il+".json AS data, "+il+".rev AS rev, "+hm+".json AS metadata";r.valid=h1,r.use_prefix=!0;var ic=fg(),jz=function(){},ir=25,h9=50,C={},U=1800,jj=jm("pouchdb:http");fT.valid=function(){return !0},ip.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},ip.prototype.finish=function(){return this.promise};var hp=function(t,aa){return aa&&t.then(function(ab){iC.nextTick(function(){aa(null,ab)})},function(ab){iC.nextTick(function(){aa(ab)})}),t},iY=function(t){return hg(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&hp(ab,aa),ab})},iG=function(t,aa){return t.then(function(ab){return aa().then(function(){return ab})},function(ab){return aa().then(function(){throw ab})})},hu=function(t,aa){return function(){var ab=arguments,ac=this;return t.add(function(){return aa.apply(ac,ab)})}},jr=function(t){for(var ab={},ac=0,aa=t.length;aa>ac;ac++){ab["$"+t[ac]]=!0}var ad=Object.keys(ab),af=new Array(ad.length);for(ac=0,aa=ad.length;aa>ac;ac++){af[ac]=ad[ac].substring(1)}return af},hh={},K=new ip,iK=50,hP=iO.bind(null,"log"),gZ={_sum:function(t,aa){return ao(aa)},_count:function(t,aa){return aa.length},_stats:function(t,aa){function ab(ah){for(var ad=0,af=0,ac=ah.length;ac>af;af++){var ag=ah[af];ad+=ag*ag}return ad}return{sum:ao(aa),min:Math.min.apply(null,aa),max:Math.max.apply(null,aa),count:aa.length,sumsqr:ab(aa)}}},ce=iY(function(){var t=this;return"http"===t.type()?G(t):"function"==typeof t._viewCleanup?iZ(t):iA(t)}),hb=function(t,ab,ac){"function"==typeof ab&&(ac=ab,ab={}),ab=ab?es(ab):{},"function"==typeof t&&(t={map:t});var aa=this,ad=gi.resolve().then(function(){return m(aa,t,ab)});return hp(ad,ac),ad};hc(a1,Error),hc(gR,Error),hc(Q,Error);var fk={query:hb,viewCleanup:ce},en=1,gU="pouchdb",hC=5,jp=0;gb.prototype.writeCheckpoint=function(t,aa){var ab=this;return this.updateTarget(t,aa).then(function(){return ab.updateSource(t,aa)})},gb.prototype.updateTarget=function(t,aa){return N(this.target,this.id,t,aa,this.returnValue)},gb.prototype.updateSource=function(t,aa){var ab=this;return this.readOnlySource?gi.resolve(!0):N(this.src,this.id,t,aa,this.returnValue)["catch"](function(ac){if(gg(ac)){return ab.readOnlySource=!0,!0}throw ac})};var ia={undefined:function(t,aa){return 0===he.collate(t.last_seq,aa.last_seq)?aa.last_seq:0},1:function(t,aa){return fs(aa,t).last_seq}};gb.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.readOnlySource?gi.resolve(aa.last_seq):t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return jp}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in ia?ia[ab](aa,ac):jp},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:jp}).then(function(){return jp},function(ac){return gg(ac)?(t.readOnlySource=!0,aa.last_seq):jp})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return jp})};var hj=0;hc(gp,i5.EventEmitter),gp.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},gp.prototype.ready=function(t,ab){function ac(){ad.cancel()}function aa(){t.removeListener("destroyed",ac),ab.removeListener("destroyed",ac)}var ad=this;ad._readyCalled||(ad._readyCalled=!0,t.once("destroyed",ac),ab.once("destroyed",ac),ad.once("complete",aa))},hc(g1,i5.EventEmitter),g1.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},fx.plugin(ji).plugin(gF).plugin(P).plugin(fk).plugin(io),a.exports=fx}).call(this,e(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(b,h,a){function e(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}h.exports=e},{}],5:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var k=arguments,h=this.useColors;if(k[0]=(h?"%c":"")+this.namespace+(h?" %c":" ")+k[0]+(h?"%c ":" ")+"+"+p.humanize(this.diff),!h){return k}var f="color: "+this.color;k=[k[0],f,"color: inherit"].concat(Array.prototype.slice.call(k,1));var j=0,g=0;return k[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(j++,"%c"===l&&(g=j))}),k.splice(g,0,f),k}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(6),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{6:6}],6:[function(s,i,a){function e(){return a.colors[t++%a.colors.length]}function b(k){function h(){}function g(){var q=g,m=+new Date,p=m-(r||m);q.diff=p,q.prev=r,q.curr=m,r=m,null==q.useColors&&(q.useColors=a.useColors()),null==q.color&&q.useColors&&(q.color=e());var w=Array.prototype.slice.call(arguments);w[0]=a.coerce(w[0]),"string"!=typeof w[0]&&(w=["%o"].concat(w));var l=0;w[0]=w[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}l++;var x=a.formatters[A];if("function"==typeof x){var z=w[l];y=x.call(q,z),w.splice(l,1),l--}return y}),"function"==typeof a.formatArgs&&(w=a.formatArgs.apply(q,w));var v=g.log||a.log||console.log.bind(console);v.apply(q,w)}h.enabled=!1,g.enabled=!0;var j=a.enabled(k)?g:h;return j.namespace=k,j}function u(g){a.save(g);for(var k=(g||"").split(/[\s,]+/),h=k.length,j=0;h>j;j++){k[j]&&(g=k[j].replace(/\*/g,".*?"),"-"===g[0]?a.skips.push(new RegExp("^"+g.substr(1)+"$")):a.names.push(new RegExp("^"+g+"$")))}}function o(){a.enable("")}function f(g){var j,h;for(j=0,h=a.skips.length;h>j;j++){if(a.skips[j].test(g)){return !1}}for(j=0,h=a.names.length;h>j;j++){if(a.names[j].test(g)){return !0}}return !1}function n(g){return g instanceof Error?g.stack||g.message:g}a=i.exports=b,a.coerce=n,a.disable=o,a.enable=u,a.enabled=f,a.humanize=s(11),a.names=[],a.skips=[],a.formatters={};var r,t=0},{11:11}],7:[function(e,a,b){(function(o){function x(){r=!0;for(var j,g,h=u.length;h;){for(g=u,u=[],j=-1;++j<h;){g[j]()}h=u.length}r=!1}function f(g){1!==u.push(g)||r||z()}var z,s=o.MutationObserver||o.WebKitMutationObserver;if(s){var n=0,i=new s(x),l=o.document.createTextNode("");i.observe(l,{characterData:!0}),z=function(){l.data=n=++n%2}}else{if(o.setImmediate||"undefined"==typeof o.MessageChannel){z="document" in o&&"onreadystatechange" in o.document.createElement("script")?function(){var g=o.document.createElement("script");g.onreadystatechange=function(){x(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},o.document.documentElement.appendChild(g)}:function(){setTimeout(x,0)}}else{var y=new o.MessageChannel;y.port1.onmessage=x,z=function(){y.port2.postMessage(0)}}}var r,u=[];a.exports=f}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(e,a,b){"function"==typeof Object.create?a.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:a.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],9:[function(e,a,b){(function(){var i=Array.prototype.slice,j=Array.prototype.forEach,f=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=i.call(arguments,1);return j.call(g,function(n){if(n){for(var m in n){"object"==typeof n[m]&&h[m]?f.call(h,h[m],n[m]):h[m]=n[m]}}}),h};this.extend=f}).call(this)},{}],10:[function(i,u,r){function l(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=a,this.queue=[],this.outcome=void 0,g!==l&&y(this,g)}function h(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function p(j,k,g){f(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function e(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(j,q){function w(A){x||(x=!0,K.reject(j,A))}function k(A){x||(x=!0,K.resolve(j,A))}function g(){q(k,w)}var x=!1,z=s(g);"error"===z.status&&w(z.value)}function s(j,q){var g={};try{g.value=j(q),g.status="success"}catch(k){g.status="error",g.value=k}return g}function o(g){return g instanceof this?g:K.resolve(new this(l),g)}function t(g){var j=new this(l);return K.reject(j,g)}function b(w){function g(E,D){function C(F){k[D]=F,++q!==B||x||(x=!0,K.resolve(A,k))}z.resolve(E).then(C,function(F){x||(x=!0,K.reject(A,F))})}var z=this;if("[object Array]"!==Object.prototype.toString.call(w)){return this.reject(new TypeError("must be an array"))}var B=w.length,x=!1;if(!B){return this.resolve([])}for(var k=new Array(B),q=0,j=-1,A=new this(l);++j<B;){g(w[j],j)}return A}function n(j){function q(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(k,B))},function(B){x||(x=!0,K.reject(k,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(j)){return this.reject(new TypeError("must be an array"))}var g=j.length,x=!1;if(!g){return this.resolve([])}for(var z=-1,k=new this(l);++z<g;){q(j[z])}return k}var f=i(7),K={},L=["REJECTED"],m=["FULFILLED"],a=["PENDING"];u.exports=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(k,q){if("function"!=typeof k&&this.state===m||"function"!=typeof q&&this.state===L){return this}var g=new this.constructor(l);if(this.state!==a){var j=this.state===m?k:q;p(g,j,this.outcome)}else{this.queue.push(new h(g,k,q))}return g},h.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},h.prototype.otherCallFulfilled=function(g){p(this.promise,this.onFulfilled,g)},h.prototype.callRejected=function(g){K.reject(this.promise,g)},h.prototype.otherCallRejected=function(g){p(this.promise,this.onRejected,g)},K.resolve=function(k,w){var g=s(e,w);if("error"===g.status){return K.reject(k,g.value)}var q=g.value;if(q){y(k,q)}else{k.state=m,k.outcome=w;for(var j=-1,x=k.queue.length;++j<x;){k.queue[j].callFulfilled(w)}}return k},K.reject=function(j,q){j.state=L,j.outcome=q;for(var g=-1,k=j.queue.length;++g<k;){j.queue[g].callRejected(q)}return j},v.resolve=o,v.reject=t,v.all=b,v.race=n},{7:7}],11:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],12:[function(r,D,o){function s(j){if(null!==j){switch(typeof j){case"boolean":return j?1:0;case"number":return i(j);case"string":return j.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var m=Array.isArray(j),v=m?j:Object.keys(j),g=-1,w=v.length,q="";if(m){for(;++g<w;){q+=o.toIndexableString(v[g])}}else{for(;++g<w;){var k=v[g];q+=o.toIndexableString(k)+o.toIndexableString(j[k])}}return q}}return""}function h(y,q){var g,k=q,j="1"===y[q];if(j){g=0,q++}else{var z="0"===y[q];q++;var w="",m=y.substring(q,q+a),v=parseInt(m,10)+e;for(z&&(v=-v),q+=a;;){var x=y[q];if("\x00"===x){break}w+=x,q++}w=w.split("."),g=1===w.length?parseInt(w,10):parseFloat(w[0]+"."+w[1]),z&&(g-=10),0!==v&&(g=parseFloat(g+"e"+v))}return{num:g,length:q-k}}function l(v,g){var m=v.pop();if(g.length){var q=g[g.length-1];m===q.element&&(g.pop(),q=g[g.length-1]);var w=q.element,j=q.index;if(Array.isArray(w)){w.push(m)}else{if(j===v.length-2){var k=v.pop();w[k]=m}else{v.push(m)}}}}function b(m,g){for(var q=Math.min(m.length,g.length),k=0;q>k;k++){var j=o.collate(m[k],g[k]);if(0!==j){return j}}return m.length===g.length?0:m.length>g.length?1:-1}function t(g,j){return g===j?0:g>j?1:-1}function f(j,m){for(var v=Object.keys(j),g=Object.keys(m),w=Math.min(v.length,g.length),q=0;w>q;q++){var k=o.collate(v[q],g[q]);if(0!==k){return k}if(k=o.collate(j[v[q]],m[g[q]]),0!==k){return k}}return v.length===g.length?0:v.length>g.length?1:-1}function n(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function i(k){if(0===k){return"1"}var y=k.toExponential().split(/e\+?/),q=parseInt(y[1],10),w=0>k,v=w?"0":"2",m=(w?-q:q)-e,j=p.padLeft(m.toString(),"0",a);v+=u+j;var x=Math.abs(parseFloat(y[0]));w&&(x=10-x);var g=x.toFixed(20);return g=g.replace(/\.?0+$/,""),v+=u+g}var e=-324,a=3,u="",p=r(13);o.collate=function(j,m){if(j===m){return 0}j=o.normalizeKey(j),m=o.normalizeKey(m);var k=n(j),g=n(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return t(j,m)}return Array.isArray(j)?b(j,m):f(j,m)},o.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var m=0;j>m;m++){g[m]=o.normalizeKey(k[m])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var q in k){if(k.hasOwnProperty(q)){var v=k[q];"undefined"!=typeof v&&(g[q]=o.normalizeKey(v))}}}}}return g},o.toIndexableString=function(g){var j="\x00";return g=o.normalizeKey(g),n(g)+u+s(g)+j},o.parseIndexableString=function(y){for(var q=[],j=[],k=0;;){var w=y[k++];if("\x00"!==w){switch(w){case"1":q.push(null);break;case"2":q.push("1"===y[k]),k++;break;case"3":var m=h(y,k);q.push(m.num),k+=m.length;break;case"4":for(var v="";;){var x=y[k];if("\x00"===x){break}v+=x,k++}v=v.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),q.push(v);break;case"5":var z={element:[],index:q.length};q.push(z.element),j.push(z);break;case"6":var g={element:{},index:q.length};q.push(g.element),j.push(g);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+w)}}else{if(1===q.length){return q.pop()}l(q,j)}}}},{13:13}],13:[function(b,h,a){function e(f,l,m){for(var g="",n=m-f.length;g.length<n;){g+=l}return g}a.padLeft=function(k,l,f){var g=e(k,l,f);return g+k},a.padRight=function(k,l,f){var g=e(k,l,f);return k+g},a.stringLexCompare=function(n,r){var g,o=n.length,f=r.length;for(g=0;o>g;g++){if(g===f){return 1}var q=n.charAt(g),i=r.charAt(g);if(q!==i){return i>q?-1:1}}return f>o?-1:0},a.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],14:[function(i,a,b){function j(){this.store={}}function e(g){if(this.store=new j,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}b.Map=j,b.Set=e,j.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},j.prototype.unmangle=function(f){return f.substring(1)},j.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},j.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},j.prototype.has=function(f){var g=this.mangle(f);return g in this.store},j.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},j.prototype.forEach=function(p){for(var h=Object.keys(this.store),o=0,f=h.length;f>o;o++){var g=h[o],n=this.store[g];g=this.unmangle(g),p(n,g)}},e.prototype.add=function(f){return this.store.set(f,!0)},e.prototype.has=function(f){return this.store.has(f)},e.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],15:[function(e,a,b){(function(){var h={}.hasOwnProperty,f=[].slice;a.exports=function(g,n){var o,p,q,r;p=[],r=[];for(o in n){h.call(n,o)&&(q=n[o],"this"!==o&&(p.push(o),r.push(q)))}return Function.apply(null,f.call(p).concat([g])).apply(n["this"],r)}}).call(this)},{}],16:[function(a,b,f){!function(i){if("object"==typeof f){b.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(l){function r(q,w,z,j,k,x){return w=i(i(w,q),i(j,x)),i(w<<k|w>>>32-k,z)}function Q(j,A,k,w,q,z,x){return r(A&k|~A&w,j,A,q,z,x)}function y(j,A,k,w,q,z,x){return r(A&w|k&~w,j,A,q,z,x)}function o(j,A,k,w,q,z,x){return r(A^k^w,j,A,q,z,x)}function v(j,A,k,w,q,z,x){return r(k^(A|~w),j,A,q,z,x)}function g(q,w){var z=q[0],j=q[1],x=q[2],k=q[3];z=Q(z,j,x,k,w[0],7,-680876936),k=Q(k,z,j,x,w[1],12,-389564586),x=Q(x,k,z,j,w[2],17,606105819),j=Q(j,x,k,z,w[3],22,-1044525330),z=Q(z,j,x,k,w[4],7,-176418897),k=Q(k,z,j,x,w[5],12,1200080426),x=Q(x,k,z,j,w[6],17,-1473231341),j=Q(j,x,k,z,w[7],22,-45705983),z=Q(z,j,x,k,w[8],7,1770035416),k=Q(k,z,j,x,w[9],12,-1958414417),x=Q(x,k,z,j,w[10],17,-42063),j=Q(j,x,k,z,w[11],22,-1990404162),z=Q(z,j,x,k,w[12],7,1804603682),k=Q(k,z,j,x,w[13],12,-40341101),x=Q(x,k,z,j,w[14],17,-1502002290),j=Q(j,x,k,z,w[15],22,1236535329),z=y(z,j,x,k,w[1],5,-165796510),k=y(k,z,j,x,w[6],9,-1069501632),x=y(x,k,z,j,w[11],14,643717713),j=y(j,x,k,z,w[0],20,-373897302),z=y(z,j,x,k,w[5],5,-701558691),k=y(k,z,j,x,w[10],9,38016083),x=y(x,k,z,j,w[15],14,-660478335),j=y(j,x,k,z,w[4],20,-405537848),z=y(z,j,x,k,w[9],5,568446438),k=y(k,z,j,x,w[14],9,-1019803690),x=y(x,k,z,j,w[3],14,-187363961),j=y(j,x,k,z,w[8],20,1163531501),z=y(z,j,x,k,w[13],5,-1444681467),k=y(k,z,j,x,w[2],9,-51403784),x=y(x,k,z,j,w[7],14,1735328473),j=y(j,x,k,z,w[12],20,-1926607734),z=o(z,j,x,k,w[5],4,-378558),k=o(k,z,j,x,w[8],11,-2022574463),x=o(x,k,z,j,w[11],16,1839030562),j=o(j,x,k,z,w[14],23,-35309556),z=o(z,j,x,k,w[1],4,-1530992060),k=o(k,z,j,x,w[4],11,1272893353),x=o(x,k,z,j,w[7],16,-155497632),j=o(j,x,k,z,w[10],23,-1094730640),z=o(z,j,x,k,w[13],4,681279174),k=o(k,z,j,x,w[0],11,-358537222),x=o(x,k,z,j,w[3],16,-722521979),j=o(j,x,k,z,w[6],23,76029189),z=o(z,j,x,k,w[9],4,-640364487),k=o(k,z,j,x,w[12],11,-421815835),x=o(x,k,z,j,w[15],16,530742520),j=o(j,x,k,z,w[2],23,-995338651),z=v(z,j,x,k,w[0],6,-198630844),k=v(k,z,j,x,w[7],10,1126891415),x=v(x,k,z,j,w[14],15,-1416354905),j=v(j,x,k,z,w[5],21,-57434055),z=v(z,j,x,k,w[12],6,1700485571),k=v(k,z,j,x,w[3],10,-1894986606),x=v(x,k,z,j,w[10],15,-1051523),j=v(j,x,k,z,w[1],21,-2054922799),z=v(z,j,x,k,w[8],6,1873313359),k=v(k,z,j,x,w[15],10,-30611744),x=v(x,k,z,j,w[6],15,-1560198380),j=v(j,x,k,z,w[13],21,1309151649),z=v(z,j,x,k,w[4],6,-145523070),k=v(k,z,j,x,w[11],10,-1120210379),x=v(x,k,z,j,w[2],15,718787259),j=v(j,x,k,z,w[9],21,-343485551),q[0]=i(z,q[0]),q[1]=i(j,q[1]),q[2]=i(x,q[2]),q[3]=i(k,q[3])}function m(q){var j,k=[];for(j=0;64>j;j+=4){k[j>>2]=q.charCodeAt(j)+(q.charCodeAt(j+1)<<8)+(q.charCodeAt(j+2)<<16)+(q.charCodeAt(j+3)<<24)}return k}function O(q){var j,k=[];for(j=0;64>j;j+=4){k[j>>2]=q[j]+(q[j+1]<<8)+(q[j+2]<<16)+(q[j+3]<<24)}return k}function s(C){var x,q,z,w,k,A,B=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(x=64;B>=x;x+=64){g(j,m(C.substring(x-64,x)))}for(C=C.substring(x-64),q=C.length,z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],x=0;q>x;x+=1){z[x>>2]|=C.charCodeAt(x)<<(x%4<<3)}if(z[x>>2]|=128<<(x%4<<3),x>55){for(g(j,z),x=0;16>x;x+=1){z[x]=0}}return w=8*B,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),A=parseInt(w[1],16)||0,z[14]=k,z[15]=A,g(j,z),j}function P(C){var A,q,z,w,k,x,B=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(A=64;B>=A;A+=64){g(j,O(C.subarray(A-64,A)))}for(C=B>A-64?C.subarray(A-64):new Uint8Array(0),q=C.length,z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],A=0;q>A;A+=1){z[A>>2]|=C[A]<<(A%4<<3)}if(z[A>>2]|=128<<(A%4<<3),A>55){for(g(j,z),A=0;16>A;A+=1){z[A]=0}}return w=8*B,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),x=parseInt(w[1],16)||0,z[14]=k,z[15]=x,g(j,z),j}function u(q){var j,k="";for(j=0;4>j;j+=1){k+=h[q>>8*j+4&15]+h[q>>8*j&15]}return k}function t(j){var k;for(k=0;k<j.length;k+=1){j[k]=u(j[k])}return j.join("")}function n(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(q,w){var z,j=q.length,k=new ArrayBuffer(j),x=new Uint8Array(k);for(z=0;j>z;z+=1){x[z]=q.charCodeAt(z)}return w?x:k}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(q,w,k){var j=new Uint8Array(q.byteLength+w.byteLength);return j.set(new Uint8Array(q)),j.set(new Uint8Array(w),q.byteLength),k?j:j.buffer}function e(q){var w,k=[],j=q.length;for(w=0;j-1>w;w+=2){k.push(parseInt(q.substr(w,2),16))}return String.fromCharCode.apply(String,k)}function p(){this.reset()}var i=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==t(s("hello"))&&(i=function(q,w){var k=(65535&q)+(65535&w),j=(q>>16)+(w>>16)+(k>>16);return j<<16|65535&k}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(k,q){return k=0|k||0,0>k?Math.max(k+q,0):Math.min(k,q)}ArrayBuffer.prototype.slice=function(x,z){var q,w,A,C,D=this.byteLength,k=j(x,D),B=D;return z!==l&&(B=j(z,D)),k>B?new ArrayBuffer(0):(q=B-k,w=new ArrayBuffer(q),A=new Uint8Array(w),C=new Uint8Array(this,k,q),A.set(C),w)}}(),p.prototype.append=function(j){return this.appendBinary(n(j)),this},p.prototype.appendBinary=function(q){this._buff+=q,this._length+=q.length;var j,k=this._buff.length;for(j=64;k>=j;j+=64){g(this._hash,m(this._buff.substring(j-64,j)))}return this._buff=this._buff.substring(j-64),this},p.prototype.end=function(q){var w,z,j=this._buff,k=j.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;k>w;w+=1){x[w>>2]|=j.charCodeAt(w)<<(w%4<<3)}return this._finish(x,k),z=t(this._hash),q&&(z=e(z)),this.reset(),z},p.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},p.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},p.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},p.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},p.prototype._finish=function(q,w){var z,j,k,x=w;if(q[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,q),x=0;16>x;x+=1){q[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),j=parseInt(z[2],16),k=parseInt(z[1],16)||0,q[14]=j,q[15]=k,g(this._hash,q)},p.hash=function(j,k){return p.hashBinary(n(j),k)},p.hashBinary=function(q,w){var k=s(q),j=t(k);return w?e(j):j},p.ArrayBuffer=function(){this.reset()},p.ArrayBuffer.prototype.append=function(q){var w,k=T(this._buff.buffer,q,!0),j=k.length;for(this._length+=q.byteLength,w=64;j>=w;w+=64){g(this._hash,O(k.subarray(w-64,w)))}return this._buff=j>w-64?new Uint8Array(k.buffer.slice(w-64)):new Uint8Array(0),this},p.ArrayBuffer.prototype.end=function(q){var w,z,j=this._buff,k=j.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;k>w;w+=1){x[w>>2]|=j[w]<<(w%4<<3)}return this._finish(x,k),z=t(this._hash),q&&(z=e(z)),this.reset(),z},p.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},p.ArrayBuffer.prototype.getState=function(){var j=p.prototype.getState.call(this);return j.buff=S(j.buff),j},p.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),p.prototype.setState.call(this,j)},p.ArrayBuffer.prototype.destroy=p.prototype.destroy,p.ArrayBuffer.prototype._finish=p.prototype._finish,p.ArrayBuffer.hash=function(q,w){var k=P(new Uint8Array(q)),j=t(k);return w?e(j):j},p})},{}],17:[function(b,h,a){function e(n,r,g){var o=g[g.length-1];n===o.element&&(g.pop(),o=g[g.length-1]);var f=o.element,q=o.index;if(Array.isArray(f)){f.push(n)}else{if(q===r.length-2){var i=r.pop();f[i]=n}else{r.push(n)}}}a.stringify=function(E){var u=[];u.push({obj:E});for(var i,D,s,n,f,l,g,r,F,o,C,t="";i=u.pop();){if(D=i.obj,s=i.prefix||"",n=i.val||"",t+=s,n){t+=n}else{if("object"!=typeof D){t+="undefined"==typeof D?null:JSON.stringify(D)}else{if(null===D){t+="null"}else{if(Array.isArray(D)){for(u.push({val:"]"}),f=D.length-1;f>=0;f--){l=0===f?"":",",u.push({obj:D[f],prefix:l})}u.push({val:"["})}else{g=[];for(r in D){D.hasOwnProperty(r)&&g.push(r)}for(u.push({val:"}"}),f=g.length-1;f>=0;f--){F=g[f],o=D[F],C=f>0?",":"",C+=JSON.stringify(F)+":",u.push({obj:o,prefix:C})}u.push({val:"{"})}}}}}return t},a.parse=function(B){for(var C,l,A,g,D,s,t,i,n,u=[],f=[],o=0;;){if(C=B[o++],"}"!==C&&"]"!==C&&"undefined"!=typeof C){switch(C){case" ":case"	":case"\n":case":":case",":break;case"n":o+=3,e(null,u,f);break;case"t":o+=3,e(!0,u,f);break;case"f":o+=4,e(!1,u,f);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(l="",o--;;){if(A=B[o++],!/[\d\.\-e\+]/.test(A)){o--;break}l+=A}e(parseFloat(l),u,f);break;case'"':for(g="",D=void 0,s=0;;){if(t=B[o++],'"'===t&&("\\"!==D||s%2!==1)){break}g+=t,D=t,"\\"===D?s++:s=0}e(JSON.parse('"'+g+'"'),u,f);break;case"[":i={element:[],index:u.length},u.push(i.element),f.push(i);break;case"{":n={element:{},index:u.length},u.push(n.element),f.push(n);break;default:throw new Error("unexpectedly reached end of input: "+C)}}else{if(1===u.length){return u.pop()}e(u.pop(),u,f)}}}},{}]},{},[3])(3)});